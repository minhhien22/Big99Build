window.__require=function t(e,i,n){function o(s,a){if(!i[s]){if(!e[s]){var c=s.split("/");if(c=c[c.length-1],!e[c]){var l="function"==typeof __require&&__require;if(!a&&l)return l(c,!0);if(r)return r(c,!0);throw new Error("Cannot find module '"+s+"'")}s=c}var h=i[s]={exports:{}};e[s][0].call(h.exports,function(t){return o(e[s][1][t]||t)},h,h.exports,t,e,i,n)}return i[s].exports}for(var r="function"==typeof __require&&__require,s=0;s<n.length;s++)o(n[s]);return o}({"XocDia.Asset":[function(t,e,i){"use strict";cc._RF.push(e,"07ba9+ZZpJIBKzWUfxN5BRH","XocDia.Asset");var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../../Scritps/Windown"),a=cc._decorator,c=a.ccclass,l=a.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.chipBetTemp=null,e.effectWin=null,e.chipBetSprites=[],e.listBetValue=[1,5,10,50,100,500,1e3,2e3,5e3,1e4,5e4,1e5,15e4,2e5],e.chipBetPool=null,e}return o(e,t),e.prototype.onLoad=function(){this.chipBetPool=new cc.NodePool("chipbet")},e.prototype.getChipBet=function(t){var e=null;0==this.chipBetPool.size()&&this.chipBetPool.put(cc.instantiate(this.chipBetTemp)),(e=this.chipBetPool.get()).active=!0,e.opacity=255,e.scale=1,e.value=0,e.gate=-1,e.playerID=0,e.isChipPayOther=null;var i=this.listBetValue.indexOf(t/1e3);return e.getComponent(cc.Sprite).spriteFrame=-1!=i?this.chipBetSprites[i]:this.chipBetSprites[this.chipBetSprites.length-1],e},e.prototype.getEffectWin=function(t,e){void 0===e&&(e=!1),cc.log("get EffectWin:"+t);var i=cc.instantiate(this.effectWin);return i.getChildByName("lbChipWin").getComponent(cc.Label).string=s.Windown.formatMoney(t),i.active=!0,i},r([l(cc.Node)],e.prototype,"chipBetTemp",void 0),r([l(cc.Node)],e.prototype,"effectWin",void 0),r([l([cc.SpriteFrame])],e.prototype,"chipBetSprites",void 0),r([c],e)}(cc.Component);i.default=h,cc._RF.pop()},{"../../../Scritps/Windown":void 0}],"XocDia.Audio":[function(t,e,i){"use strict";cc._RF.push(e,"293a67QZZhAVb+CmWPxfcC1","XocDia.Audio");var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../../Scritps/Parent/AudioManager"),a=cc._decorator,c=a.ccclass,l=a.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bgm_fs=null,e.click=null,e.youWin=null,e.gateWinEffect=null,e.dealer_startBet=null,e.dealer_endBet=null,e.getChip=null,e.chipMoveToPlayer_turn1=null,e.chipMoveToPlayer_turn2=null,e.throwChip=null,e.openPopup=null,e.shake=null,e.selectChip=null,e}return o(e,t),e.prototype.start=function(){},e.prototype.playClick=function(){this.playEffect(this.click)},e.prototype.playMusic=function(){cc.log("chay vao play music "+this.isActiveMusic),this.isActiveMusic&&this.backgroundMusicAudio&&(cc.audioEngine.playMusic(this.backgroundMusicAudio,!0),cc.audioEngine.setMusicVolume(1))},e.prototype.playIndexTakeLine=function(){},e.prototype.playSmalWin=function(){},e.prototype.playBkgfs=function(){this.stopMusic(),this.playEffect(this.bgm_fs,.6,!0)},e.prototype.stopBkgFs=function(){this.stopEffect(this.bgm_fs,!0),this.playMusic()},r([l(cc.AudioClip)],e.prototype,"bgm_fs",void 0),r([l(cc.AudioClip)],e.prototype,"click",void 0),r([l(cc.AudioClip)],e.prototype,"youWin",void 0),r([l(cc.AudioClip)],e.prototype,"gateWinEffect",void 0),r([l(cc.AudioClip)],e.prototype,"dealer_startBet",void 0),r([l(cc.AudioClip)],e.prototype,"dealer_endBet",void 0),r([l(cc.AudioClip)],e.prototype,"getChip",void 0),r([l(cc.AudioClip)],e.prototype,"chipMoveToPlayer_turn1",void 0),r([l(cc.AudioClip)],e.prototype,"chipMoveToPlayer_turn2",void 0),r([l(cc.AudioClip)],e.prototype,"throwChip",void 0),r([l(cc.AudioClip)],e.prototype,"openPopup",void 0),r([l(cc.AudioClip)],e.prototype,"shake",void 0),r([l(cc.AudioClip)],e.prototype,"selectChip",void 0),r([c],e)}(s.default);i.default=h,cc._RF.pop()},{"../../../Scritps/Parent/AudioManager":void 0}],"XocDia.ButtonBet":[function(t,e,i){"use strict";cc._RF.push(e,"6daadHpDktO5ZKLZpNabYMQ","XocDia.ButtonBet");var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../../Scritps/Windown"),a=cc._decorator,c=a.ccclass,l=a.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scrBtn=null,e.btnX2=null,e.btnRebet=null,e.currbetBtnBet=null,e.chipBorder=null,e.listBetValue=[1,5,10,50,100,500,1e3,2e3,5e3,1e4,5e4,15e4,2e5],e.currentBetValue=1,e}return o(e,t),e.prototype.start=function(){var t=this;this.scrBtn.content.children.forEach(function(e,i){var n=new cc.Component.EventHandler;n.target=t.node,n.component="XocDia.ButtonBet",n.handler="onClickBet",n.customEventData=t.listBetValue[i]+"",e.getComponent(cc.Button).clickEvents.push(n)}),this.currbetBtnBet.y=10},e.prototype.onClickBet=function(t,e){cc.log("clickbet:"+e),s.Windown.XocDiaView.audio.playEffect(s.Windown.XocDiaView.audio.selectChip),cc.tween(this.currbetBtnBet).to(.1,{y:0}).start(),this.currbetBtnBet=t.target,this.chipBorder.parent=this.currbetBtnBet,this.currentBetValue=1e3*parseInt(e),s.Windown.XocDiaView.currentBetValue=this.currentBetValue,cc.tween(this.currbetBtnBet).to(.1,{y:10}).start()},e.prototype.onClickX2=function(){s.Windown.XocDiaView.audio.playEffect(s.Windown.XocDiaView.audio.click);var t=s.Windown.XocDiaView.HistoryBet.getTotalHistoryBet(),e=s.Windown.XocDiaView.HistoryBet.ListGateBet;if(2*t>s.Windown.User.userAg)s.Windown.UIManager.showAlertMini("B\u1ea1n kh\xf4ng \u0111\u1ee7 ti\u1ec1n c\u01b0\u1ee3c X2!");else{for(var i=0;i<5;i++)e[i]>0&&(s.Windown.XocDiaController.sendBet(i+1,2*e[i]),s.Windown.XocDiaController.isCanSendData=!0);this.btnRebet.interactable=!1,this.btnX2.interactable=!1}},e.prototype.onClickRebet=function(){s.Windown.XocDiaView.audio.playEffect(s.Windown.XocDiaView.audio.click);var t=s.Windown.XocDiaView.HistoryBet.getTotalHistoryBet(),e=s.Windown.XocDiaView.HistoryBet.ListGateBet;if(t>s.Windown.User.userAg)s.Windown.UIManager.showAlertMini("B\u1ea1n kh\xf4ng \u0111\u1ee7 ti\u1ec1n c\u01b0\u1ee3c l\u1ea1i!");else{for(var i=0;i<5;i++)e[i]>0&&(s.Windown.XocDiaController.sendBet(i+1,e[i]),s.Windown.XocDiaController.isCanSendData=!0);this.btnRebet.interactable=!1,this.btnX2.interactable=!1}},e.prototype.onChangeListChip=function(t,e){var i=this.scrBtn.getScrollOffset(),n=this.scrBtn.getMaxScrollOffset();"previous"==e?i.x<0&&cc.tween(this.scrBtn.content).to(.3,{x:this.scrBtn.content.x+100}).start():Math.abs(i.x)<n.x&&cc.tween(this.scrBtn.content).to(.3,{x:this.scrBtn.content.x-100}).start()},e.prototype.setStatusBtnBet=function(){var t=s.Windown.XocDiaView.HistoryBet.getTotalHistoryBet();cc.log("setStatusBtnBet:"+t),t>0?(this.btnRebet.interactable=t<=s.Windown.User.userAg,this.btnX2.interactable=2*t<s.Windown.User.userAg):this.btnRebet.interactable=this.btnX2.interactable=!1},r([l(cc.ScrollView)],e.prototype,"scrBtn",void 0),r([l(cc.Button)],e.prototype,"btnX2",void 0),r([l(cc.Button)],e.prototype,"btnRebet",void 0),r([l(cc.Node)],e.prototype,"currbetBtnBet",void 0),r([l(cc.Node)],e.prototype,"chipBorder",void 0),r([c],e)}(cc.Component);i.default=h,cc._RF.pop()},{"../../../Scritps/Windown":void 0}],"XocDia.ChipBet":[function(t,e,i){"use strict";cc._RF.push(e,"c41c3Rg9BNEEbe+xpreKHrd","XocDia.ChipBet");var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=cc._decorator,a=s.ccclass,c=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.playerID=0,e.value=0,e.gate=-1,e}return o(e,t),r([a],e)}(cc.Component));i.default=c,cc._RF.pop()},{}],"XocDia.HistoryBet":[function(t,e,i){"use strict";cc._RF.push(e,"0afbaenS3xHFYYrLbhyNI+F","XocDia.HistoryBet");var n=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var o=cc._decorator,r=o.ccclass,s=(o.property,function(){function t(){this.BET_C=0,this.BET_L=0,this.BET_4T=0,this.BET_4D=0,this.BET_3T=0,this.BET_3D=0,this.ListGateBet=[this.BET_C,this.BET_L,this.BET_4T,this.BET_4D,this.BET_3T,this.BET_3D]}return t.prototype.resetHistory=function(){this.ListGateBet.forEach(function(){})},t.prototype.getTotalHistoryBet=function(){var t=0;return this.ListGateBet.forEach(function(e){t+=e}),t},n([r],t)}());i.default=s,cc._RF.pop()},{}],"XocDia.HistoryMini":[function(t,e,i){"use strict";cc._RF.push(e,"1c097kcUcBA94D37PyE66ec","XocDia.HistoryMini");var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0}),cc.Enum({CHAN:1,LE:2,BON_TRANG:3,BON_DO:4,BA_TRANG:5,BA_DO:6});var s=cc._decorator,a=s.ccclass,c=s.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lbTotalChan=null,e.lbTotalLe=null,e.lbTotal4Trang=null,e.lbTotal4Do=null,e.lbTotal3Trang=null,e.lbTotal3Do=null,e.itemContainer=null,e.itemTemplate=null,e.markRecentMatch=null,e.sprResult=[],e.startPosItem=null,e.spacingY=18.6,e.spacingX=28.067,e.totalChan=0,e.totalLe=0,e.total4Trang=0,e.total4Do=0,e.total3Trang=0,e.total3Do=0,e}return o(e,t),e.prototype.onLoad=function(){this.startPosItem=cc.v2(169.347,36.738)},e.prototype.start=function(){},e.prototype.setInfo=function(t,e){void 0===e&&(e=!1);for(var i=0,n=t.length;i<n;i++){var o=t[i],r=null;if(o<25?(r=this.sprResult[0],this.totalChan++,13==o?this.total4Trang++:14==o&&this.total4Do++):(this.totalLe++,r=this.sprResult[1],25==o?this.total3Trang++:26==o&&this.total3Do++),i<65){var s=void 0,a=this.getPosItem(i);(s=cc.instantiate(this.itemTemplate)).parent=this.itemContainer,s.setPosition(a),s.active=!0,s.setSiblingIndex(i),s.getComponent(cc.Sprite).spriteFrame=r}}this.lbTotalChan.string=this.totalChan+"",this.lbTotalLe.string=this.totalLe+"",this.lbTotal4Trang.string=this.total4Trang+"",this.lbTotal4Do.string=this.total4Do+"",this.lbTotal3Trang.string=this.total3Trang+"",this.lbTotal3Do.string=this.total3Do+"",cc.tween(this.markRecentMatch).sequence(cc.tween().to(.5,{scale:1}),cc.tween().to(.5,{scale:.8})).repeatForever().start()},e.prototype.addItemHistory=function(t){var e=this;this.markRecentMatch.active=!1,t.length>65&&(t=t.slice(0,65));var i,n=cc.instantiate(this.itemTemplate);n.parent=this.itemContainer,n.setSiblingIndex(0),n.active=!0,n.setPosition(cc.v2(this.getPosItem(0).x+100,this.getPosItem(0).y)),t[0]<25?(this.totalChan++,i=this.sprResult[0],13==t[0]?this.total4Trang++:14==t[0]&&this.total4Do++):(this.totalLe++,i=this.sprResult[1],25==t[0]?this.total3Trang++:26==t[0]&&this.total3Do++),n.getComponent(cc.Sprite).spriteFrame=i;for(var o=function(t,i){var n=r.itemContainer.children[t],o=r.getPosItem(t);cc.tween(n).to(.3,{x:o.x,y:o.y}).call(function(){t==i-1&&(e.markRecentMatch.active=!0,cc.tween(e.markRecentMatch).sequence(cc.tween().to(.5,{scale:1}),cc.tween().to(.5,{scale:.8})).repeatForever().start())}).start()},r=this,s=0,a=t.length;s<a;s++)o(s,a);var c=this.itemContainer.children[this.itemContainer.childrenCount-1];cc.tween(c).to(.3,{x:c.x-100}).call(function(){c.destroy()}).start()},e.prototype.getPosItem=function(t){var e=cc.v2(0,0);if(t<5)e=cc.v2(this.startPosItem.x,this.startPosItem.y-t*this.spacingY);else{var i=Math.floor(t/5);e.x=this.startPosItem.x-i*this.spacingX,e.y=i%2==0?this.startPosItem.y-t%5*this.spacingY:this.startPosItem.y-(4-t%5)*this.spacingY}return e},e.prototype.getTypeGate=function(){},r([c(cc.Label)],e.prototype,"lbTotalChan",void 0),r([c(cc.Label)],e.prototype,"lbTotalLe",void 0),r([c(cc.Label)],e.prototype,"lbTotal4Trang",void 0),r([c(cc.Label)],e.prototype,"lbTotal4Do",void 0),r([c(cc.Label)],e.prototype,"lbTotal3Trang",void 0),r([c(cc.Label)],e.prototype,"lbTotal3Do",void 0),r([c(cc.Node)],e.prototype,"itemContainer",void 0),r([c(cc.Node)],e.prototype,"itemTemplate",void 0),r([c(cc.Node)],e.prototype,"markRecentMatch",void 0),r([c([cc.SpriteFrame])],e.prototype,"sprResult",void 0),r([a],e)}(cc.Component);i.default=l,cc._RF.pop()},{}],"XocDia.MenuView":[function(t,e,i){"use strict";cc._RF.push(e,"740ce0tUW9KXobEp3dFbdo+","XocDia.MenuView");var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},s=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(o,r){function s(t){try{c(n.next(t))}catch(e){r(e)}}function a(t){try{c(n.throw(t))}catch(e){r(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(s,a)}c((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var i,n,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(t){return function(e){return c([t,e])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(a){r=[6,a],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var c=t("../../../Scritps/Windown"),l=cc._decorator,h=l.ccclass,p=l.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.container=null,e.tglSound=null,e.tglMusic=null,e}return o(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){this.tglSound.isChecked=!c.Windown.XocDiaView.audio.isActiveSound,this.tglMusic.isChecked=!c.Windown.XocDiaView.audio.isActiveMusic},e.prototype.onshow=function(){cc.tween(this.node.getChildByName("mask")).to(.3,{opacity:100}).start(),cc.tween(this.container).set({x:-cc.winSize.width/2-this.container.width/2-50}).to(.3,{x:-cc.winSize.width/2+this.container.width/2},{easing:cc.easing.sineIn}).start()},e.prototype.onHide=function(){var t=this;cc.tween(this.node.getChildByName("mask")).to(.3,{opacity:100}).start(),cc.tween(this.container).set({x:-cc.winSize.width/2+this.container.width/2}).to(.3,{x:-cc.winSize.width/2-this.container.width/2-50},{easing:cc.easing.sineOut}).call(function(){t.node.active=!1}).start()},e.prototype.onClickBack=function(){c.Windown.XocDiaView.audio.playClick(),c.Windown.XocDiaController.onClickBackToLobby(),this.onHide()},e.prototype.onClickRule=function(){return s(this,void 0,void 0,function(){var t,e;return a(this,function(i){switch(i.label){case 0:return c.Windown.XocDiaView.audio.playEffect(c.Windown.XocDiaView.audio.openPopup),[4,c.Windown.XocDiaController.loadPrefabBundle("PopupRule")];case 1:return t=i.sent(),(e=cc.instantiate(t)).parent=c.Windown.XocDiaView.node,c.Windown.actionEffectOpen(e),cc.find("Container/btnClose",e).once("click",function(){c.Windown.actionEffectClose(e,function(){e.destroy()})}),this.onHide(),[2]}})})},e.prototype.onClickHistoryBet=function(){return s(this,void 0,void 0,function(){var t,e;return a(this,function(i){switch(i.label){case 0:return[4,c.Windown.XocDiaController.loadPrefabBundle("PopupHistory")];case 1:return t=i.sent(),(e=cc.instantiate(t)).parent=c.Windown.XocDiaView.node,c.Windown.actionEffectOpen(e),this.onHide(),[2]}})})},e.prototype.onClickSetting=function(){return s(this,void 0,void 0,function(){var t,e;return a(this,function(i){switch(i.label){case 0:return c.Windown.XocDiaView.audio.playEffect(c.Windown.XocDiaView.audio.openPopup),[4,c.Windown.XocDiaController.loadPrefabBundle("PopupSetting")];case 1:return t=i.sent(),(e=cc.instantiate(t)).parent=c.Windown.XocDiaView.node,c.Windown.actionEffectOpen(e),this.onHide(),[2]}})})},e.prototype.onClickTglSound=function(){c.Windown.XocDiaView.audio.isActiveSound=!this.tglSound.isChecked},e.prototype.onClickTglMusic=function(){c.Windown.XocDiaView.audio.isActiveMusic=!this.tglMusic.isChecked},r([p(cc.Node)],e.prototype,"container",void 0),r([p(cc.Toggle)],e.prototype,"tglSound",void 0),r([p(cc.Toggle)],e.prototype,"tglMusic",void 0),r([h],e)}(cc.Component);i.default=u,cc._RF.pop()},{"../../../Scritps/Windown":void 0}],"XocDia.Player":[function(t,e,i){"use strict";cc._RF.push(e,"16146LwvOZKXrj5ft0gjYRD","XocDia.Player");var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},s=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(o,r){function s(t){try{c(n.next(t))}catch(e){r(e)}}function a(t){try{c(n.throw(t))}catch(e){r(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(s,a)}c((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var i,n,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(t){return function(e){return c([t,e])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(a){r=[6,a],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var c=t("../../../Scritps/DefineTs/PathResource"),l=t("../../../Scritps/Obs/LbMoneyChange"),h=t("../../../Scritps/Util"),p=t("../../../Scritps/Windown"),u=cc._decorator,f=u.ccclass,d=u.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lbNickName=null,e.lbChips=null,e.avatar=null,e.lbChipWin=null,e.posPayChip=[],e.spineEffectWin=null,e.dynamicIndex=0,e.nickname="Player",e.currentChips=0,e.id=0,e.isThisPlayer=!1,e.listChipBet=[],e.listChipPay=[],e.gateBetted=[],e.effecWin=null,e}return o(e,t),e.prototype.start=function(){},e.prototype.setInfo=function(t,e,i,n){this.setName(e),this.setId(t),this.setChip(i),this.setAvatar(n)},e.prototype.setName=function(t){this.lbNickName.string=t,this.nickname=t,t.length>10&&(this.lbNickName.string=t.slice(0,7)+"...")},e.prototype.setChip=function(t,e){void 0===e&&(e=!0),this.isThisPlayer?this.lbChips.setMoney(t,!1):this.lbChips.setMoney(t,e),this.currentChips=t},e.prototype.setAvatar=function(t){return s(this,void 0,void 0,function(){var e,i;return a(this,function(n){switch(n.label){case 0:return e=c.PathResource.Avatar.replace("%d",t.toString()),[4,p.Windown.getSpFrameRes(e)];case 1:return i=n.sent(),this.avatar.spriteFrame=i,[2]}})})},e.prototype.setId=function(t){this.id=t},e.prototype.getChipBet=function(t){this.listChipBet.forEach(function(e){var i=t.parent.convertToWorldSpaceAR(t.position),n=e.parent.convertToNodeSpaceAR(i);cc.tween(e).to(1,{position:n},{easing:cc.easing.quintOut}).start(),cc.tween(e).to(1,{opacity:0},{easing:cc.easing.sineOut}).start()})},e.prototype.showWinEffect=function(t,e){return void 0===e&&(e=!1),s(this,void 0,void 0,function(){var i=this;return a(this,function(){return[2,new Promise(function(n){return s(i,void 0,void 0,function(){var i,o=this;return a(this,function(){try{null==this.effecWin?(this.effecWin=p.Windown.XocDiaView.assets.getEffectWin(t),this.effecWin.y=20):this.effecWin.getChildByName("lbChipWin").getComponent(cc.Label).string=p.Windown.formatMoney(t),(i=this.effecWin.getComponentInChildren(sp.Skeleton)).setCompleteListener(null),this.effecWin.parent=this.node,this.effecWin.active=!0,e||(i.setSkin("win"),i.setSlotsToSetupPose(),i.setAnimation(0,"appear",!1),i.setCompleteListener(function(){i.setAnimation(0,"idle",!1),i.setCompleteListener(function(){i.setCompleteListener(null)})}),this.scheduleOnce(function(){n(null),o.effecWin.active=!1},3))}catch(r){h.Util.ThrowErrProsime(r)}return[2]})})})]})})},e.prototype.showWinSpineEffect=function(t){var e=this;this.spineEffectWin.node.scale=1,this.spineEffectWin.node.active=!0,this.lbChipWin.string=p.Windown.formatMoney(t),this.lbChipWin.node.parent.active=!0,this.spineEffectWin.setSkin("win"),this.spineEffectWin.setSlotsToSetupPose(),this.spineEffectWin.setAnimation(0,"appear",!1),cc.tween(this.lbChipWin.node.parent).set({scaleX:0}).to(.3,{scaleX:.5},{easing:cc.easing.backOut}).start(),this.spineEffectWin.setCompleteListener(function(){e.spineEffectWin.setAnimation(0,"idle",!1),e.spineEffectWin.setCompleteListener(null)}),this.scheduleOnce(function(){e.hideSpineWin()},3)},e.prototype.hideSpineWin=function(){var t=this;cc.tween(this.spineEffectWin.node).to(.2,{scaleX:0},{easing:cc.easing.backIn}).call(function(){t.spineEffectWin.node.active=!1}).start()},e.prototype.showButtonBet=function(){this.node.getComponent(cc.Animation).play("EffectShowBtnBet"),p.Windown.XocDiaView.buttonBetController.setStatusBtnBet()},e.prototype.hideButtonBet=function(){this.node.getComponent(cc.Animation).play("EffectHideBtnBet")},e.prototype.resetPlayer=function(){this.listChipBet=[],this.listChipPay=[],this.gateBetted=[]},r([d(cc.Label)],e.prototype,"lbNickName",void 0),r([d(l.default)],e.prototype,"lbChips",void 0),r([d(cc.Sprite)],e.prototype,"avatar",void 0),r([d(cc.Label)],e.prototype,"lbChipWin",void 0),r([d([cc.Vec2])],e.prototype,"posPayChip",void 0),r([d(sp.Skeleton)],e.prototype,"spineEffectWin",void 0),r([d],e.prototype,"isThisPlayer",void 0),r([f],e)}(cc.Component);i.default=y,cc._RF.pop()},{"../../../Scritps/DefineTs/PathResource":void 0,"../../../Scritps/Obs/LbMoneyChange":void 0,"../../../Scritps/Util":void 0,"../../../Scritps/Windown":void 0}],"XocDia.PopupHistory":[function(t,e,i){"use strict";cc._RF.push(e,"459b67FXrVD/I05ckH3Ox8M","XocDia.PopupHistory");var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s};Object.defineProperty(i,"__esModule",{value:!0});var s=t("../../../Scritps/Windown"),a=cc._decorator,c=a.ccclass,l=a.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprGate=[],e.lbSession=null,e.lbScoreP=null,e.lbScoreB=null,e.lbPage=null,e.scrItemHis=null,e.itemHisTemp=null,e.currentIndexSession=0,e.historyData=[],e}return o(e,t),e.prototype.onLoad=function(){s.Windown.XocDiaView.popupHistoryBetView=this},e.prototype.start=function(){s.Windown.XocDiaController.sendGetHistoryBet()},e.prototype.setInfo=function(t){this.historyData=JSON.parse(s.Windown.SFSObjToJson(t)).history,this.historyData.reverse(),cc.log("historyData===",this.historyData),this.setInfoSession(this.historyData[this.currentIndexSession]),this.lbPage.string="1/"+this.historyData.length},e.prototype.setInfoSession=function(t){var e=t.round,i=s.Windown.formatDate(new Date(t.time),"HH:mm:ss dd/MM/yyyy");this.lbSession.string=cc.js.formatStr("S\u1ed1 Phi\xean:#%s(%s)",e,i),this.lbPage.string=this.currentIndexSession+1+"/"+this.historyData.length;var n=t.bet;this.scrItemHis.content.children.forEach(function(t){t.active=!1});for(var o=0;o<n.length;o++){var r=n[o],a=this.scrItemHis.content.children[o];cc.isValid(a)||((a=cc.instantiate(this.itemHisTemp)).parent=this.scrItemHis.content),a.active=!0,a.getChildByName("lbGateBet").getComponent(cc.Label).string=this.getNameGate(r.id),a.getChildByName("lbbetValue").getComponent(cc.Label).string=s.Windown.formatMoney(r.agBet,1,100),0==r.agWin?(a.getChildByName("lbWinValue").getComponent(cc.Label).string="-"+s.Windown.formatMoney(r.agBet,1,100),a.getChildByName("lbWinValue").color=cc.Color.RED):(a.getChildByName("lbWinValue").color=cc.Color.GREEN,a.getChildByName("lbWinValue").getComponent(cc.Label).string="+"+s.Windown.formatMoney(r.agWin,1,100))}},e.prototype.getNameGate=function(t){var e="";switch(t){case 1:e="CH\u1eb4N";break;case 2:e="L\u1eba";break;case 3:e="CH\u1eb4N 4 TR\u1eaeNG";break;case 4:e="CH\u1eb4N 4 \u0110\u1ece";break;case 5:e="L\u1eba 3 TR\u1eaeNG";break;case 6:e="L\u1eba 3 \u0110\u1ece"}return e},e.prototype.onClickClose=function(){var t=this;s.Windown.actionEffectClose(this.node,function(){t.node.destroy(),s.Windown.XocDiaView.popupHistoryBetView=null})},e.prototype.onClickChangePage=function(t,e){"next"==e?this.currentIndexSession<=this.historyData.length-2&&this.currentIndexSession++:this.currentIndexSession>0&&this.currentIndexSession--,this.setInfoSession(this.historyData[this.currentIndexSession])},r([l([cc.SpriteFrame])],e.prototype,"sprGate",void 0),r([l(cc.Label)],e.prototype,"lbSession",void 0),r([l(cc.Label)],e.prototype,"lbScoreP",void 0),r([l(cc.Label)],e.prototype,"lbScoreB",void 0),r([l(cc.Label)],e.prototype,"lbPage",void 0),r([l(cc.ScrollView)],e.prototype,"scrItemHis",void 0),r([l(cc.Node)],e.prototype,"itemHisTemp",void 0),r([c],e)}(cc.Component);i.default=h,cc._RF.pop()},{"../../../Scritps/Windown":void 0}],XocDiaController:[function(t,e,i){"use strict";cc._RF.push(e,"440f3d1eKVPqIHVED0IdO6E","XocDiaController");var n=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(o,r){function s(t){try{c(n.next(t))}catch(e){r(e)}}function a(t){try{c(n.throw(t))}catch(e){r(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(s,a)}c((n=n.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){var i,n,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(t){return function(e){return c([t,e])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(a){r=[6,a],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../../Scritps/DefineTs/EVENT_MANAGER"),s=t("../../../Scritps/DefineTs/REQUEST_CODE"),a=t("../../../Scritps/DefineTs/TextDefine"),c=t("../../../Scritps/Game/GAME_TYPE"),l=t("../../../Scritps/Network/ConectManager"),h=t("../../../Scritps/Windown"),p=cc.Enum({BETTING:1,FINISHED:2,WAITTING:3}),u=function(){function t(){this.sfs=null,this.roomSFS=null,this.listTimeOut=[],this.objFinish=null,this.gameType=0,this.isCanSendData=!0,this.joinRoomData=null,this.infoRoom=null,this.startGameData=null,this.sfs=l.ConectManager.getIns().sfs,this.sfs.addEventListener(SFS2X.SFSEvent.USER_EXIT_ROOM,this.userExitRoom,this),this.sfs.addEventListener(SFS2X.SFSEvent.ROOM_CREATION_ERROR,this.onCreateError,this),this.sfs.addEventListener(SFS2X.SFSEvent.ROOM_JOIN,this.onJoinRoom,this),this.sfs.addEventListener(SFS2X.SFSEvent.ROOM_JOIN_ERROR,this.onJoinRoomErr,this),this.sfs.addEventListener(SFS2X.SFSEvent.EXTENSION_RESPONSE,this.extResponse,this),h.Windown.XocDiaController=this,cc.systemEvent.on(r.EVENT_MANAGER.onDisconnect,this.onDisconnect,this)}return t.prototype.onDisconnect=function(){this.clear(),this.xocDiaView.node.destroy()},t.prototype.clear=function(){cc.systemEvent.targetOff(this),this.sfs.removeEventListener(SFS2X.SFSEvent.USER_EXIT_ROOM,this.userExitRoom),this.sfs.removeEventListener(SFS2X.SFSEvent.ROOM_JOIN,this.onJoinRoom),this.sfs.removeEventListener(SFS2X.SFSEvent.ROOM_JOIN_ERROR,this.onJoinRoomErr),this.sfs.removeEventListener(SFS2X.SFSEvent.EXTENSION_RESPONSE,this.extResponse),this.objFinish&&(this.objFinish.get("agWin"),h.Windown.MoneyUser.removeDelay(this.gameType)),h.Windown.MoneyUser.endGameMOney(this.gameType),cc.log("CLEAR XD CONTROLLER"),h.Windown.XocDiaController=null},t.prototype.userExitRoom=function(t){if("Xocdia"==t.room.groupId&&t.user.isItMe)return this.onDestroy(),cc.log("C"),void cc.director.loadScene("main")},t.prototype.onCreateError=function(){cc.log("creat err"),h.Windown.UIManager.hideLoading(),this.onDestroy(),h.Windown.Dialog.showLog(a.TextDefine.ERR_JOIN_ROOM)},t.prototype.onDestroy=function(){h.Windown.UIManager.hideLoadingData(),h.Windown.UIManager.hideLoading(),cc.systemEvent.removeAll(this),this.clearAllTimeOut(),this.sfs.removeEventListener(SFS2X.SFSEvent.USER_EXIT_ROOM,this.userExitRoom),this.sfs.removeEventListener(SFS2X.SFSEvent.ROOM_CREATION_ERROR,this.onCreateError),this.sfs.removeEventListener(SFS2X.SFSEvent.ROOM_JOIN,this.onJoinRoom),this.sfs.removeEventListener(SFS2X.SFSEvent.ROOM_JOIN_ERROR,this.onJoinRoomErr),this.sfs.removeEventListener(SFS2X.SFSEvent.EXTENSION_RESPONSE,this.extResponse),h.Windown.XocDiaController=null,this.roomSFS=null,h.Windown.MoneyUser.targetOff(this),h.Windown.MoneyUser.endGameMOney(c.default.XocDia),cc.log("REMOVE ALL XD Controller")},t.prototype.clearAllTimeOut=function(){this.listTimeOut.forEach(function(t){clearTimeout(t)})},t.prototype.onJoinRoom=function(t){return n(this,void 0,void 0,function(){return o(this,function(){return cc.log("onJoinRoom:",t),t.room,h.Windown.UIManager.hideLoadingData(),[2]})})},t.prototype.onJoinRoomErr=function(){h.Windown.UIManager.hideLoading(),h.Windown.Dialog.showLog(a.TextDefine.ERR_JOIN_ROOM),this.onDestroy()},t.prototype.extResponse=function(t){var e=t.cmd,i=t.params;switch(e){case s.REQUEST_CODE.XDPlayerInfo:this.xocDiaView.handlePlayerInfo(i);break;case s.REQUEST_CODE.XDInfoRoom:cc.log("XDVIEW=="+cc.isValid(this.xocDiaView)),this.xocDiaView.handleRoomInfo(i);break;case s.REQUEST_CODE.XDStartGame:cc.log("XDStartGame:",h.Windown.SFSObjToJson(i)),null==this.xocDiaView?this.startGameData=i:this.xocDiaView.handleStartGame(i);break;case s.REQUEST_CODE.XDBet:this.xocDiaView.handlePlayerBet(i);break;case s.REQUEST_CODE.XDEndGame:cc.log("XDEndGame:",h.Windown.SFSObjToJson(i)),this.xocDiaView.handleEndGame(i);break;case s.REQUEST_CODE.XDHistoryBet:this.xocDiaView.popupHistoryBetView.setInfo(i);break;case s.REQUEST_CODE.XDAutoExit:i.getBool("status")&&(cc.director.loadScene("main"),this.onDisconnect())}},t.prototype.sendJoinRoom=function(){var t=this;cc.log("sendJoinRoom XD"),h.Windown.UIManager.showLoading();var e=this.sfs.roomManager.getRoomListFromGroup("X").find(function(t){return cc.log("value"+t.getVariable("cj").value),t.containsVariable("cj")&&t.getVariable("cj").value});e?(this.roomSFS=e,e.isJoined?this.sendGetInfoRoom():(cc.log("nhay vao send join rom: "+e),this.sfs.send(new SFS2X.JoinRoomRequest(e,null,-1)))):setTimeout(function(){t.sendJoinRoom()},3e3)},t.prototype.sendGetInfoRoom=function(){this.sendRequest(s.REQUEST_CODE.XDInfoRoom,l.ConectManager.getIns().getSFSObj())},t.prototype.sendRequest=function(t,e){l.ConectManager.getIns().sendRequest(t,e,this.roomSFS)},t.prototype.sendToServer=function(t,e){this.isCanSendData&&null!=this.roomSFS&&(this.isCanSendData=!1,l.ConectManager.getIns().sendRequest(t,e,this.roomSFS))},t.prototype.sendBet=function(t,e){var i=l.ConectManager.getIns().getSFSObj();i.putLong("bet",e),i.putInt("id",t),this.sendToServer("bet",i)},t.prototype.sendLeaveRoom=function(){cc.log("SendLeaveRoom");var t=l.ConectManager.getIns().getSFSObj();this.sendToServer("atS",t)},t.prototype.intiGame=function(){return n(this,void 0,void 0,function(){var t;return o(this,function(e){switch(e.label){case 0:return[4,h.Windown.loadBundle(c.default.XocDia.toString())];case 1:return t=e.sent(),h.Windown.UIManager.showLoadingData(),t.preloadScene("XocDia",{},function(t,e){h.Windown.UIManager.setPerData(t/e)},function(e){e?h.Windown.Dialog.showLog(a.TextDefine.Error):t.loadScene("XocDia",function(t,e){if(t)return h.Windown.Dialog.showLog(a.TextDefine.Error),void h.Windown.UIManager.hideLoadingData();cc.director.runScene(e,null,function(){h.Windown.UIManager.hideLoadingData()})})}),[2]}})})},t.prototype.onClickBackToLobby=function(){this.roomSFS?this.xocDiaView.isPlayerBetted?this.xocDiaView.gameState==p.WAITTING?this.sendLeaveRoom():(this.xocDiaView.isAutoExit=!this.xocDiaView.isAutoExit,this.xocDiaView.isAutoExit?h.Windown.UIManager.showAlertMini("\u0110\xe3 \u0111\u0103ng k\xfd r\u1eddi b\xe0n v\xe0o cu\u1ed1i v\xe1n"):h.Windown.UIManager.showAlertMini("\u0110\xe3 h\u1ee7y \u0111\u0103ng k\xfd r\u1eddi b\xe0n")):this.sendLeaveRoom():cc.log("Ko co ROOMSFS")},t.prototype.loadPrefabBundle=function(t){return n(this,void 0,void 0,function(){var e;return o(this,function(){return e=cc.assetManager.getBundle(c.default.XocDia.toString()),[2,new Promise(function(i,n){e.load("Prefab/"+t,function(t,e){if(t)return n(t),null;i(e)})})]})})},t.prototype.sendGetHistoryBet=function(){var t=l.ConectManager.getIns().getSFSObj();this.sendToServer("historyBetBa",t),cc.log("sendToServer historyBetBa :"),h.Windown.XocDiaController.isCanSendData=!0},t}();i.default=u,cc._RF.pop()},{"../../../Scritps/DefineTs/EVENT_MANAGER":void 0,"../../../Scritps/DefineTs/REQUEST_CODE":void 0,"../../../Scritps/DefineTs/TextDefine":void 0,"../../../Scritps/Game/GAME_TYPE":void 0,"../../../Scritps/Network/ConectManager":void 0,"../../../Scritps/Windown":void 0}],XocDiaView:[function(t,e,i){"use strict";cc._RF.push(e,"bf116bROndNH77eP12k8MTD","XocDiaView");var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),r=this&&this.__decorate||function(t,e,i,n){var o,r=arguments.length,s=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,n);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(s=(r<3?o(s):r>3?o(e,i,s):o(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},s=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(o,r){function s(t){try{c(n.next(t))}catch(e){r(e)}}function a(t){try{c(n.throw(t))}catch(e){r(e)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof i?e:new i(function(t){t(e)})).then(s,a)}c((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var i,n,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(t){return function(e){return c([t,e])}}function c(r){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(o=2&r[0]?n.return:r[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,r[1])).done)return o;switch(n=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,n=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(a){r=[6,a],n=0}finally{i=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var c=t("../../../Scritps/Obs/LbMoneyChange"),l=t("../../../Scritps/Other/MakeDelay"),h=t("../../../Scritps/Util"),p=t("../../../Scritps/Windown"),u=t("./XocDia.Asset"),f=t("./XocDia.Audio"),d=t("./XocDia.ButtonBet"),y=t("./XocDia.HistoryBet"),g=t("./XocDia.HistoryMini"),v=t("./XocDia.MenuView"),b=t("./XocDia.Player"),w=t("./XocDia.PopupHistory"),m=cc._decorator,B=m.ccclass,C=m.property,T=cc.Enum({BETTING:1,FINISHED:2,WAITTING:3}),D=cc.Enum({CHAN:1,LE:2,BON_TRANG:3,BON_DO:4,BA_TRANG:5,BA_DO:6}),S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.players=[],e.thisPlayer=null,e.lbOtherPlayer=null,e.lbTimer=null,e.lbWaitting=null,e.lbSession=null,e.lbTotalBet=null,e.lbTotalGateBetUser=[],e.lbTotalBetC=null,e.lbTotalBetL=null,e.lbTotalBet4T=null,e.lbTotalBet4D=null,e.lbTotalBet3T=null,e.lbTotalBet3D=null,e.buttonBetController=null,e.popupHistoryBetView=null,e.audio=null,e.sprTimeRemainCenter=null,e.sprTimer=null,e.historyMini=null,e.menu=null,e.nodeGroupUser=null,e.nodeGateBet=[],e.nodeGetChip=null,e.chipOnGateContainer=null,e.posPayChipOther=[],e.assets=null,e.listPosChipOnTable=[],e.animDealer=null,e.effectWinOther=null,e.listGateWin=[],e.gateWin=null,e.HistoryBet=null,e.listLbTotalBet=[],e.listChipbetOther=[],e.makeDelay=null,e.agUser=0,e.listValueChip=[.1,1,5,10,50,100,500,1e3,2e3,5e3,1e4,5e4,1e5,15e4,2e5],e.timeInBg=0,e.currentTimer=30,e.totalBetAllGate=0,e.gameState=T.BETTING,e.lastPlayerInfoData=null,e.listDataPlayerOther=[],e.historyTable=[],e.listBtnBet=[],e.listTotalUserBetGate=null,e.listChipBet=[],e.totalBetC=0,e.totalBetL=0,e.totalBet4T=0,e.totalBet4D=0,e.totalBet3T=0,e.totalBet3D=0,e.currentBetValue=1e3,e.listTotalBetValue=null,e.isResetView=!1,e.isPlayerBetted=!1,e.isAutoExit=!1,e.isEndBetting=!1,e}return o(e,t),e.prototype.onLoad=function(){var t=this;this.HistoryBet=new y.default,this.listTotalBetValue=[this.totalBetC,this.totalBetL,this.totalBet4T,this.totalBet4D,this.totalBet3T,this.totalBet3D],this.listTotalUserBetGate=[0,0,0,0,0,0],this.listLbTotalBet=[this.lbTotalBetC,this.lbTotalBetL,this.lbTotalBet4T,this.lbTotalBet4D,this.lbTotalBet3T,this.lbTotalBet3D];for(var e=0,i=this.listValueChip.length;e<i;e++)this.listValueChip[e]*=1e3;p.Windown.XocDiaController.xocDiaView=this,p.Windown.XocDiaView=this,this.makeDelay=new l.default(this),this.agUser=p.Windown.User.userAg,this.nodeGateBet.forEach(function(e){t.listBtnBet.push(e.getComponent(cc.Button))}),this.listTotalUserBetGate=[0,0,0,0,0,0]},e.prototype.start=function(){p.Windown.XocDiaController.sendJoinRoom(),this.audio.playMusic(),null!=p.Windown.XocDiaController.startGameData&&(this.handleStartGame(p.Windown.XocDiaController.startGameData),p.Windown.XocDiaController.startGameData=null),this.setupTimeRunInBg()},e.prototype.onDestroy=function(){cc.log("Set XocdiaView Null"),p.Windown.XocDiaView=null},e.prototype.handleStartGame=function(t){var e=this;this.gameState!=T.BETTING&&(this.audio.playEffect(this.audio.dealer_startBet),this.gameState=T.BETTING,this.isResetView=!1,this.lbSession.string="#"+t.getInt("sision"),this.currentTimer=t.getInt("time")-2,this.audio.playEffect(this.audio.shake),this.setDealerAnim("XOC",!1,function(){e.setDealerAnim("cuoc"),e.setStateBtnGate(!0),e.lbWaitting.node.active=!0,e.lbTimer.string=e.currentTimer+"",e.sprTimer.fillRange=1,e.onCountTimeRemain()}),this.thisPlayer.showButtonBet())},e.prototype.handleRoomInfo=function(t){return s(this,void 0,void 0,function(){var e,i,n,o,r,s,c=this;return a(this,function(a){switch(a.label){case 0:return p.Windown.UIManager.hideLoading(),cc.log("handleRoomInfo XD:"+p.Windown.SFSObjToJson(t)),this.setDealerAnim("idle",!0),this.currentTimer=t.getInt("time"),this.lbSession.string="#"+t.getInt("sision"),e=t.getBool("isG"),i=JSON.parse(p.Windown.SFSArrToJson(t.get("cur"))),this.gameState=e?T.BETTING:T.FINISHED,this.historyTable=JSON.parse(t.get("his")).reverse(),n=this.historyTable[0],this.gameState==T.FINISHED&&this.currentTimer>15&&this.historyTable.splice(0,1),this.setStateBtnGate(this.gameState==T.BETTING),this.historyMini.setInfo(this.historyTable),this.gameState==T.BETTING?this.onCountTimeRemain():this.onCountWaitting(),this.gameState!=T.BETTING?[3,1]:(this.thisPlayer.showButtonBet(),this.setCurBetInfo(i),[3,8]);case 1:return p.Windown.UIManager.showAlertMini("Vui l\xf2ng ch\u1edd  v\xe1n ch\u01a1i k\u1ebft th\xfac!"),o=JSON.parse(p.Windown.SFSArrToJson(t.get("w"))),this.listGateWin=[],o.forEach(function(t){c.listGateWin.push(t.id)}),r=this.getAnimResult(),this.setDealerAnim("idle_"+r,!1,function(){}),this.currentTimer>=15?(s=JSON.parse(p.Windown.SFSArrToJson(t.get("cur"))),this.setCurBetInfo(s),[4,p.Windown.XocDiaView.getMakeDelay(.5).prosime]):[3,8];case 2:return a.sent(),this.listGateWin=[],s.forEach(function(t){t.w&&c.listGateWin.push(t.id)}),this.gateWin=parseInt(this.listGateWin.toString().split(",").join("")),[4,this.showWinResult()];case 3:return a.sent(),this.getAllChipOnTable(),[4,this.getMakeDelay(1.5).prosime];case 4:return a.sent(),this.payChipWinOnTalbe(),[4,this.getMakeDelay(1.5).prosime];case 5:return a.sent(),this.moveChipToPlayer(),[4,this.getMakeDelay(1.5).prosime];case 6:return a.sent(),[4,this.showResultAgWinReconnect(s)];case 7:a.sent(),this.historyTable.unshift(n),this.resetView(),a.label=8;case 8:return[2]}})})},e.prototype.showResultAgWinReconnect=function(t){return void 0===t&&(t=[]),s(this,void 0,void 0,function(){return a(this,function(){return[],[2]})})},e.prototype.moveChipToPlayer=function(){var t=this,e=cc.find("bg/playerContainer",this.node),i=!1;this.players.forEach(function(n){n.listChipBet.forEach(function(o,r){if(r<7){cc.isValid(o.parent)||(cc.log("Chip ko co cha:",o.playerID),o.parent=t.nodeGateBet[o.gate-1]);var s=p.Windown.convertNodeInOtherNode(o,e);o.parent=e,o.setPosition(s),i=!0,cc.tween(o).to(.6,{x:n.posPayChip[0].x,y:n.posPayChip[0].y+5*r,scale:.8*o.scale}).delay(1).to(.3,{position:n.node.position}).call(function(){t.assets.chipBetPool.put(o)}).start()}else cc.tween(o).to(.3,{opacity:0},{easing:cc.easing.sineOut}).call(function(){t.assets.chipBetPool.put(o)}).start()}),n.listChipPay.forEach(function(o,r){if(r<7)if(cc.isValid(o.parent)||(cc.log("Chip ko co cha:",o.playerID),o.parent=t.nodeGateBet[o.gate-1]),cc.isValid(o.parent)){var s=p.Windown.convertNodeInOtherNode(o,e);o.parent=e,o.setPosition(s),i=!0,cc.tween(o).to(.6,{x:n.posPayChip[1].x,y:n.posPayChip[1].y+5*r,scale:.8*o.scale}).delay(.75).to(.3,{position:n.node.position}).call(function(){t.assets.chipBetPool.put(o)}).start()}else cc.tween(o).to(.1,{opacity:0}).call(function(){t.assets.chipBetPool.put(o)});else cc.tween(o).to(.3,{opacity:0},{easing:cc.easing.sineOut}).call(function(){t.assets.chipBetPool.put(o)}).start()})});var n=0;this.listChipbetOther.forEach(function(o,r){if(r<7){i=!0,n+=o.value;var s=p.Windown.convertNodeInOtherNode(o,e);o.parent=e,o.setPosition(s);var a=1==o.isChipPayOther?0:1;cc.tween(o).to(.6,{x:t.posPayChipOther[a].x,y:t.posPayChipOther[a].y+5*r,scale:.8*o.scale}).delay(.75).to(.3,{position:t.nodeGroupUser.position}).call(function(){t.assets.chipBetPool.put(o)}).start()}else n+=o.value,t.assets.chipBetPool.put(o)}),this.listChipbetOther.length>0&&cc.tween(this.node).delay(1.5).call(function(){t.showEffectWinOther(n)}).start(),this.listChipBet.forEach(function(e){cc.isValid(t.getPlayerWithId(e.playerID))||t.listChipbetOther.includes(e)||cc.tween(e).to(.3,{opacity:0},{easing:cc.easing.sineOut}).call(function(){t.assets.chipBetPool.put(e)}).start()}),i&&this.audio.playEffect(this.audio.chipMoveToPlayer_turn1)},e.prototype.showEffectWinOther=function(t){var e=this;null==this.effectWinOther?(this.effectWinOther=this.assets.getEffectWin(t),this.effectWinOther.parent=this.node,this.effectWinOther.position=this.nodeGroupUser.position):this.effectWinOther.getChildByName("lbChipWin").getComponent(cc.Label).string=p.Windown.formatMoney(t),this.effectWinOther.active=!0;var i=this.effectWinOther.getComponentInChildren(sp.Skeleton);i.setSkin("win"),i.setSlotsToSetupPose(),i.setAnimation(0,"appear",!1),i.setCompleteListener(function(){i.setAnimation(0,"idle",!1),i.setCompleteListener(null)}),this.scheduleOnce(function(){cc.tween(e.effectWinOther).to(.2,{scaleX:0},{easing:cc.easing.backIn}).call(function(){e.effectWinOther.active=!1}).start()},3)},e.prototype.onClickShowMenu=function(){this.audio.playClick(),this.menu.node.active=!0,this.menu.onshow()},e.prototype.getChipWinValueOnGate=function(t,e){switch(e){case D.LE:case D.CHAN:t*=1.97;break;case D.BON_DO:case D.BON_TRANG:t*=15;break;case D.BA_TRANG:case D.BA_DO:t*=3.9}return t},e.prototype.effectChipPay=function(t,e,i,n,o){void 0===o&&(o=null);var r=this.assets.getChipBet(t);r.isChipPayOther=n==this.listChipbetOther,n.push(r);var s=this.nodeGateBet[e-1];r.parent=s;var a=e>3?40:60,c=p.Windown.RandomNumber(this.listPosChipOnTable[e-1].x-a,this.listPosChipOnTable[e-1].x+a),l=p.Windown.RandomNumber(this.listPosChipOnTable[e-1].y,this.listPosChipOnTable[e-1].y+a),h=cc.v2(c,l);i=i<.75?i:.75,r.opacity=0,cc.tween(r).set({x:h.x,y:h.y+50,opacity:0}).delay(i).to(.3,{x:h.x,y:h.y,opacity:255},{easing:cc.easing.sineIn}).call(function(){null!=o&&o()}).start()},e.prototype.payChipWinOnTalbe=function(){for(var t=this,e=!1,i=function(i){var o=n.listGateWin[i];n.players.forEach(function(i){i.listChipBet.forEach(function(n,r){if(n.gate==o){e=!0,n.value=t.getChipWinValueOnGate(n.value,o);for(var s=t.getListChipValue(n.value),a=0,c=s.length;a<c;a++)t.effectChipPay(s[a],o,.07*r,i.listChipPay)}})}),n.listChipbetOther.forEach(function(i,n){if(i.gate==o){e=!0,i.value=t.getChipWinValueOnGate(i.value,o);for(var r=t.getListChipValue(i.value),s=0,a=r.length;s<a;s++)t.effectChipPay(r[s],o,.07*n,t.listChipbetOther)}})},n=this,o=0;o<this.listGateWin.length;o++)i(o);e&&this.audio.playEffect(this.audio.chipMoveToPlayer_turn1)},e.prototype.getAllChipOnTable=function(){var t=this;this.audio.playEffect(this.audio.getChip),this.listChipBet.forEach(function(e){if(!t.listGateWin.includes(e.gate)){cc.isValid(e.parent)||(cc.log("Chip ko co cha:",e.playerID),e.parent=t.nodeGateBet[e.gate-1]);var i=t.nodeGetChip.parent.convertToWorldSpaceAR(t.nodeGetChip.position),n=p.Windown.convertPosInOtherNode(e.getPosition(),e.parent,t.chipOnGateContainer);e.parent=t.chipOnGateContainer,e.setPosition(n);var o=e.parent.convertToNodeSpaceAR(i);cc.tween(e).delay(p.Windown.RandomNumber(0,3)/10).to(1.5,{x:o.x,y:o.y+50},{easing:cc.easing.quintOut}).to(.1,{opacity:0}).call(function(){t.assets.chipBetPool.put(e);var i=t.getPlayerWithId(e.playerID);null!=i&&i.listChipBet.splice(i.listChipBet.indexOf(e),1),t.listChipbetOther.includes(e)&&t.listChipbetOther.splice(t.listChipbetOther.indexOf(e),1)}).start()}})},e.prototype.showWinResult=function(){return s(this,void 0,void 0,function(){var t=this;return a(this,function(){return[2,new Promise(function(e){return s(t,void 0,void 0,function(){var t,i=this;return a(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),this.audio.playEffect(this.audio.gateWinEffect),this.listGateWin.forEach(function(t){i.listBtnBet[t-1].getComponentInChildren(cc.Animation).node.active=!0}),[4,this.getMakeDelay(1.5).prosime];case 1:return n.sent(),e(null),[3,3];case 2:return t=n.sent(),h.Util.ThrowErrProsime(t),[3,3];case 3:return[2]}})})})]})})},e.prototype.getAnimResult=function(){return this.listGateWin.includes(3)?"4trang":this.listGateWin.includes(4)?"4den":this.listGateWin.includes(5)?"3trang":this.listGateWin.includes(6)?"3den":"2_2"},e.prototype.getGateWinNormal=function(){var t=0,e=[1,3,4];return this.listGateWin.some(function(t){return e.includes(t)})?(t=D.CHAN,cc.log("RESULT-----\x3e CHAN")):(t=D.LE,cc.log("RESULT-----\x3e LE")),t},e.prototype.getMakeDelay=function(t){return this.makeDelay.getDelay(t)},e.prototype.handlePlayerBet=function(t){cc.log("handlePlayerBet:"+p.Windown.SFSObjToJson(t));var e=t.getInt("pid");this.audio.playEffect(this.audio.throwChip);var i=t.getInt("id"),n=this.getPlayerWithId(e),o=t.getLong("bet");if(null!=n&&n==this.thisPlayer){if(t.containsKey("errorMessage")&&""!=t.getUtfString("errorMessage"))return void p.Windown.UIManager.showAlertMini(t.getUtfString("errorMessage"));this.isPlayerBetted=!0,this.totalBetAllGate+=o,this.listTotalUserBetGate[i-1]+=o,this.lbTotalBet.setMoney(this.totalBetAllGate,!0),this.lbTotalGateBetUser[i-1].string=p.Windown.formatMoney(this.listTotalUserBetGate[i-1]),this.lbTotalGateBetUser[i-1].node.parent.active=!0}for(var r=this.getListChipValue(o),s=0,a=r.length;s<a;s++){var c=this.assets.getChipBet(r[s]);c.active=!0,this.listChipBet.push(c);var l=this.nodeGateBet[i-1],h=null;null!=n?(h=l.convertToNodeSpaceAR(n.node.parent.convertToWorldSpaceAR(n.node.position)),n.setChip(t.getLong("ag")),n.listChipBet.push(c),c.playerID=n.id,n.gateBetted.includes(i)||n.gateBetted.push(i)):(h=l.convertToNodeSpaceAR(this.nodeGroupUser.parent.convertToWorldSpaceAR(this.nodeGroupUser.position)),this.listChipbetOther.push(c),c.playerID=-1),c.parent=l,c.gate=i,c.value=r[s],c.setPosition(h);var u=i>3?40:60,f=p.Windown.RandomNumber(this.listPosChipOnTable[i-1].x-u,this.listPosChipOnTable[i-1].x+u),d=p.Windown.RandomNumber(0,this.listPosChipOnTable[i-1].y+u),y=cc.v2(f,d);cc.tween(c).set({position:h}).delay(.05*s).to(.3,{x:y.x,y:y.y},{easing:cc.easing.sineOut}).start()}this.listTotalBetValue[i-1]=t.getLong("ttB"),this.listLbTotalBet[i-1].setMoney(this.listTotalBetValue[i-1],!0)},e.prototype.setupTimeRunInBg=function(){var t=this;cc.game.on(cc.game.EVENT_HIDE,function(){t.timeInBg=cc.sys.now()}),cc.game.on(cc.game.EVENT_SHOW,function(){var e=cc.sys.now(),i=t.timeInBg;cc.director.getActionManager().update((e-i)/1e3),cc.Tween.stopAllByTag(1),(e-i)/1e3>15&&null!=p.Windown.XocDiaController&&p.Windown.XocDiaController.onClickBackToLobby()})},e.prototype.handlePlayerInfo=function(t){if(cc.log("handlePlayerInfo:"+p.Windown.SFSObjToJson(t)),this.gameState!=T.FINISHED){this.listDataPlayerOther=[];var e=JSON.parse(p.Windown.SFSArrToJson(t.get("data"))),i=e.find(function(t){return t.id==p.Windown.User.userId});null!=i&&(cc.log("Co this player trong listPlayer, xoa no di"),e.splice(e.indexOf(i),1)),7==e.length&&(this.listDataPlayerOther.push(e.pop()),cc.log("Co 7 player trong listPlayer, xoa 1 thang  di:"+e.length)),this.thisPlayer.setAvatar(p.Windown.User.avatrId),this.thisPlayer.setName(p.Windown.User.nickName),this.thisPlayer.setChip(this.agUser,!1),this.thisPlayer.setId(p.Windown.User.userId);for(var n=1,o=0,r=e.length;o<r;o++){var s=e[o],a=this.players[n];cc.isValid(a)&&a!=this.thisPlayer?(a.node.active=!0,a.resetPlayer(),a.setInfo(s.id,s.nn,s.ag,s.iv),n++):cc.error(" ko du player de hien thi")}for(o=n;o<this.players.length;o++)this.players[o].node.active=!1,this.players[o].resetPlayer();this.lbOtherPlayer.string=t.getInt("so")+this.listDataPlayerOther.length+""}else this.lastPlayerInfoData=t},e.prototype.onCountWaitting=function(){var t=this;this.lbTimer.node.active=!1,this.sprTimeRemainCenter.node.parent.active=!0,this.lbWaitting.node.active=!0,this.sprTimer.fillRange=0,this.sprTimeRemainCenter.fillRange=1,cc.Tween.stopAllByTarget(this.lbWaitting),cc.Tween.stopAllByTarget(this.sprTimeRemainCenter),cc.tween(this.lbWaitting).repeatForever(cc.tween().set({string:"Ch\u1edd V\xe1n M\u1edbi"}).delay(.5).set({string:"Ch\u1edd V\xe1n M\u1edbi."}).delay(.5).set({string:"Ch\u1edd V\xe1n M\u1edbi.."}).delay(.5).set({string:"Ch\u1edd V\xe1n M\u1edbi..."}).delay(.5)).start(),cc.tween(this.sprTimeRemainCenter).to(this.currentTimer,{fillRange:0}).call(function(){t.lbWaitting.node.active=!1,t.sprTimeRemainCenter.node.parent.active=!1}).start()},e.prototype.onCountTimeRemain=function(){var t=this;this.lbTimer.node.active=!0,this.lbWaitting.node.active=!0,this.lbWaitting.string="Ch\u1edd \u0110\u1eb7t C\u01b0\u1ee3c",this.sprTimer.node.parent.active=!0,cc.Tween.stopAllByTarget(this.lbWaitting),cc.Tween.stopAllByTarget(this.lbTimer),cc.Tween.stopAllByTarget(this.sprTimeRemainCenter),cc.Tween.stopAllByTarget(this.sprTimer),this.unscheduleAllCallbacks(),this.lbTimer.string=this.currentTimer+"",this.schedule(function(){t.currentTimer>0?(t.currentTimer--,t.currentTimer<4&&t.gameState==T.BETTING&&!t.isEndBetting&&(t.isEndBetting=!0,t.setDealerAnim("dungcuoc",!1)),t.lbTimer.string=t.currentTimer+"",t.currentTimer<6&&cc.tween(t.lbTimer.node).to(.3,{scale:1.2},{easing:cc.easing.sineOut}).to(.3,{scale:1},{easing:cc.easing.sineIn}).start()):t.lbTimer.string="0"},1,this.currentTimer),cc.tween(this.sprTimer).set({fillRange:1}).to(this.currentTimer,{fillRange:0}).start(),this.sprTimeRemainCenter.node.parent.active=!0,cc.tween(this.sprTimeRemainCenter).set({fillRange:1}).to(this.currentTimer,{fillRange:0}).call(function(){t.sprTimeRemainCenter.node.parent.active=!1,t.lbWaitting.node.active=!1}).start()},e.prototype.setStateBtnGate=function(t){this.listBtnBet.forEach(function(e){e.interactable=t})},e.prototype.setCurBetInfo=function(t){for(var e=0;e<t.length;e++){for(var i=t[e],n=i.id,o=i.b,r=0;r<o.length;r++)for(var s=o[r].bet,a=this.getPlayerWithId(o[r].idP),c=this.getListChipValue(s),l=0,h=c.length;l<h;l++){var u=this.assets.getChipBet(c[l]);cc.isValid(a)?(a.id==p.Windown.User.userId&&(this.totalBetAllGate+=s,this.listTotalUserBetGate[n-1]+=s,this.lbTotalBet.setMoney(this.totalBetAllGate,!0),this.lbTotalGateBetUser[n-1].string=p.Windown.formatMoney(this.listTotalUserBetGate[n-1]),this.lbTotalGateBetUser[n-1].node.parent.active=!0),a.listChipBet.push(u),u.playerID=a.id):(this.listChipbetOther.push(u),u.playerID=-1),this.listChipBet.push(u),u.parent=this.nodeGateBet[n-1],u.gate=n,u.value=c[l];var f=n>3?40:60,d=p.Windown.RandomNumber(this.listPosChipOnTable[n-1].x-f,this.listPosChipOnTable[n-1].x+f),y=p.Windown.RandomNumber(0,this.listPosChipOnTable[n-1].y+f);u.setPosition(cc.v2(d,y))}switch(n){case D.CHAN:this.totalBetC=i.t;break;case D.LE:this.totalBetL=i.t;break;case D.BON_TRANG:this.totalBet4T=i.t;break;case D.BON_DO:this.totalBet4D=i.t;break;case D.BA_TRANG:this.totalBet3T=i.t;break;case D.BA_DO:this.totalBet3D=i.t}this.lbTotalBetC.setMoney(this.totalBetC,!0),this.lbTotalBetL.setMoney(this.totalBetL,!0),this.lbTotalBet4T.setMoney(this.totalBet4T,!0),this.lbTotalBet4D.setMoney(this.totalBet4D,!0),this.lbTotalBet3T.setMoney(this.totalBet3T,!0),this.lbTotalBet3D.setMoney(this.totalBet3D,!0)}},e.prototype.getPlayerWithId=function(t){return t==p.Windown.User.userId?this.thisPlayer:this.players.find(function(e){return e.id==t})},e.prototype.getListChipValue=function(t){var e=[];return this.getNameChip(t,e),e},e.prototype.getNameChip=function(t,e){var i,n,o=0;cc.log;for(var r=0;r<this.listValueChip.length;r++)if(this.listValueChip[r]>t){o=this.listValueChip[r-1];break}if(0==o)for(r=this.listValueChip.length-1;r>=0;r++)if(t>=this.listValueChip[r]){o=this.listValueChip[r];break}if(i=Math.floor(t/o),t=n=t%o,o>=1e3)for(r=0;r<i;r++)e.push(o);n>0&&this.getNameChip(t,e)},e.prototype.onClickSendBet=function(t,e){p.Windown.XocDiaController.sendBet(parseInt(e),this.currentBetValue),setTimeout(function(){p.Windown.XocDiaController.isCanSendData=!0},500)},e.prototype.handleEndGame=function(t){return s(this,void 0,void 0,function(){var e,i,n,o,r,s=this;return a(this,function(a){switch(a.label){case 0:return cc.log("handleEndGame"),this.setStateBtnGate(!1),this.currentTimer=15,this.onCountWaitting(),this.sprTimer.fillRange=0,this.gameState=T.FINISHED,this.thisPlayer.hideButtonBet(),this.audio.playEffect(this.audio.dealer_endBet),this.historyTable=JSON.parse(t.get("his")).reverse(),e=JSON.parse(p.Windown.SFSArrToJson(t.get("d7"))),i=t.getLong("agW"),this.agUser=t.getLong("ag"),p.Windown.User.userAg=this.agUser,n=JSON.parse(p.Windown.SFSArrToJson(t.get("w"))),this.listGateWin=[],n.forEach(function(t){s.listGateWin.push(t.id)}),o=this.getAnimResult(),this.setDealerAnim("mo_"+o,!1,function(){s.setDealerAnim("win_"+o,!1,function(){})}),r=this.animDealer.findAnimation("mo_"+o).duration,[4,p.Windown.XocDiaView.getMakeDelay(r+.5).prosime];case 1:return a.sent(),this.gateWin=parseInt(this.listGateWin.toString().split(",").join("")),[4,this.showWinResult()];case 2:return a.sent(),this.getAllChipOnTable(),[4,this.getMakeDelay(1.5).prosime];case 3:return a.sent(),this.payChipWinOnTalbe(),[4,this.getMakeDelay(1.5).prosime];case 4:return a.sent(),this.moveChipToPlayer(),[4,this.getMakeDelay(1.5).prosime];case 5:return a.sent(),[4,this.showResultAgWin(e,i)];case 6:return a.sent(),this.resetView(),[2]}})})},e.prototype.setDealerAnim=function(t,e,i){var n=this;void 0===e&&(e=!1),void 0===i&&(i=null),this.animDealer.setAnimation(0,t,e),this.animDealer.setCompleteListener(null),null!=i?this.animDealer.setCompleteListener(i):this.animDealer.setCompleteListener(function(){n.animDealer.setAnimation(0,"idle",!0)})},e.prototype.showResultAgWin=function(t,e){return void 0===t&&(t=[]),s(this,void 0,void 0,function(){var i,n,o=this;return a(this,function(r){switch(r.label){case 0:return i=[],n=!1,t.forEach(function(t){var e=t.id,r=o.getPlayerWithId(e);cc.isValid(r)&&t.agw>0&&r!=o.thisPlayer&&(n=!0,i.push(r.showWinEffect(t.agw)),r.setChip(t.ag))}),0!=e&&(i.push(this.thisPlayer.showWinSpineEffect(e)),this.thisPlayer.setChip(this.agUser),this.audio.playEffect(this.audio.youWin)),n&&this.audio.playEffect(this.audio.chipMoveToPlayer_turn2),[4,Promise.all(i)];case 1:return r.sent(),[4,this.getMakeDelay(.25).prosime];case 2:return r.sent(),[2]}})})},e.prototype.resetView=function(){var t=this;this.isResetView||(this.isEndBetting=!1,this.isPlayerBetted=!1,this.isResetView=!0,this.totalBetAllGate=0,this.lbTotalBet.setMoney(0),this.listChipBet.forEach(function(e){t.assets.chipBetPool.put(e)}),this.listChipBet=[],this.listChipbetOther.forEach(function(e){t.assets.chipBetPool.put(e)}),this.listChipbetOther=[],this.totalBetC=this.totalBetL=this.totalBet4D=this.totalBet4T=this.totalBet3D=this.totalBet3T=0,this.listBtnBet.forEach(function(t){t.getComponentInChildren(cc.Animation).node.active=!1}),this.players.forEach(function(t){t.resetPlayer()}),this.gameState=T.WAITTING,null!=this.lastPlayerInfoData&&(this.handlePlayerInfo(this.lastPlayerInfoData),this.lastPlayerInfoData=null),this.listLbTotalBet.forEach(function(t){t.setMoneyNoTime(0)}),this.lbTotalGateBetUser.forEach(function(e,i){e.node.parent.active=!1,t.HistoryBet.ListGateBet[i]=t.listTotalUserBetGate[i],t.listTotalUserBetGate[i]=0}),this.historyMini.addItemHistory(this.historyTable),1==this.isAutoExit&&p.Windown.XocDiaController.onClickBackToLobby())},r([C([b.default])],e.prototype,"players",void 0),r([C(b.default)],e.prototype,"thisPlayer",void 0),r([C(cc.Label)],e.prototype,"lbOtherPlayer",void 0),r([C(cc.Label)],e.prototype,"lbTimer",void 0),r([C(cc.Label)],e.prototype,"lbWaitting",void 0),r([C(cc.Label)],e.prototype,"lbSession",void 0),r([C(c.default)],e.prototype,"lbTotalBet",void 0),r([C([cc.Label])],e.prototype,"lbTotalGateBetUser",void 0),r([C(c.default)],e.prototype,"lbTotalBetC",void 0),r([C(c.default)],e.prototype,"lbTotalBetL",void 0),r([C(c.default)],e.prototype,"lbTotalBet4T",void 0),r([C(c.default)],e.prototype,"lbTotalBet4D",void 0),r([C(c.default)],e.prototype,"lbTotalBet3T",void 0),r([C(c.default)],e.prototype,"lbTotalBet3D",void 0),r([C(d.default)],e.prototype,"buttonBetController",void 0),r([C(w.default)],e.prototype,"popupHistoryBetView",void 0),r([C(f.default)],e.prototype,"audio",void 0),r([C(cc.Sprite)],e.prototype,"sprTimeRemainCenter",void 0),r([C(cc.Sprite)],e.prototype,"sprTimer",void 0),r([C(g.default)],e.prototype,"historyMini",void 0),r([C(v.default)],e.prototype,"menu",void 0),r([C(cc.Node)],e.prototype,"nodeGroupUser",void 0),r([C([cc.Node])],e.prototype,"nodeGateBet",void 0),r([C(cc.Node)],e.prototype,"nodeGetChip",void 0),r([C(cc.Node)],e.prototype,"chipOnGateContainer",void 0),r([C([cc.Vec2])],e.prototype,"posPayChipOther",void 0),r([C(u.default)],e.prototype,"assets",void 0),r([C([cc.Vec2])],e.prototype,"listPosChipOnTable",void 0),r([C(sp.Skeleton)],e.prototype,"animDealer",void 0),r([B],e)}(cc.Component);i.default=S,cc._RF.pop()},{"../../../Scritps/Obs/LbMoneyChange":void 0,"../../../Scritps/Other/MakeDelay":void 0,"../../../Scritps/Util":void 0,"../../../Scritps/Windown":void 0,"./XocDia.Asset":"XocDia.Asset","./XocDia.Audio":"XocDia.Audio","./XocDia.ButtonBet":"XocDia.ButtonBet","./XocDia.HistoryBet":"XocDia.HistoryBet","./XocDia.HistoryMini":"XocDia.HistoryMini","./XocDia.MenuView":"XocDia.MenuView","./XocDia.Player":"XocDia.Player","./XocDia.PopupHistory":"XocDia.PopupHistory"}]},{},["XocDia.Asset","XocDia.Audio","XocDia.ButtonBet","XocDia.ChipBet","XocDia.HistoryBet","XocDia.HistoryMini","XocDia.MenuView","XocDia.Player","XocDia.PopupHistory","XocDiaController","XocDiaView"]);