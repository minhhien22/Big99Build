window.__require=function e(t,i,n){function r(a,c){if(!i[a]){if(!t[a]){var s=a.split("/");if(s=s[s.length-1],!t[s]){var l="function"==typeof __require&&__require;if(!c&&l)return l(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+a+"'")}a=s}var d=i[a]={exports:{}};t[a][0].call(d.exports,function(e){return r(t[a][1][e]||e)},d,d.exports,e,t,i,n)}return i[a].exports}for(var o="function"==typeof __require&&__require,a=0;a<n.length;a++)r(n[a]);return r}({AudioTL:[function(e,t,i){"use strict";cc._RF.push(t,"12f4f+39W1Knbt7MwWTXeMS","AudioTL");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=this&&this.__decorate||function(e,t,i,n){var r,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(o<3?r(a):o>3?r(t,i,a):r(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var a=e("../../../Scritps/Parent/AudioManager"),c=cc._decorator,s=c.ccclass,l=c.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.anBai=null,t.chiabaiLoop=null,t.click=null,t.danhBaiVaBocBai=null,t.denTurn=null,t.dichuyenLabai=null,t.Lose=null,t.Win=null,t.startGame=null,t.alert=null,t.fold=null,t.nemxu=null,t.bom=null,t.kiss=null,t.rose=null,t.beer=null,t.water=null,t}return r(t,e),t.prototype.playClick=function(){this.playEffect(this.click)},t.prototype.playMusic=function(){this.isActiveMusic&&this.backgroundMusicAudio&&(cc.audioEngine.playMusic(this.backgroundMusicAudio,!0),cc.audioEngine.setMusicVolume(.6))},t.prototype.playIndexTakeLine=function(){},t.prototype.playSmalWin=function(){},o([l(cc.AudioClip)],t.prototype,"anBai",void 0),o([l(cc.AudioClip)],t.prototype,"chiabaiLoop",void 0),o([l(cc.AudioClip)],t.prototype,"click",void 0),o([l(cc.AudioClip)],t.prototype,"danhBaiVaBocBai",void 0),o([l(cc.AudioClip)],t.prototype,"denTurn",void 0),o([l(cc.AudioClip)],t.prototype,"dichuyenLabai",void 0),o([l(cc.AudioClip)],t.prototype,"Lose",void 0),o([l(cc.AudioClip)],t.prototype,"Win",void 0),o([l(cc.AudioClip)],t.prototype,"startGame",void 0),o([l(cc.AudioClip)],t.prototype,"alert",void 0),o([l(cc.AudioClip)],t.prototype,"fold",void 0),o([l(cc.AudioClip)],t.prototype,"nemxu",void 0),o([l(cc.AudioClip)],t.prototype,"bom",void 0),o([l(cc.AudioClip)],t.prototype,"kiss",void 0),o([l(cc.AudioClip)],t.prototype,"rose",void 0),o([l(cc.AudioClip)],t.prototype,"beer",void 0),o([l(cc.AudioClip)],t.prototype,"water",void 0),o([s],t)}(a.default);i.default=d,cc._RF.pop()},{"../../../Scritps/Parent/AudioManager":void 0}],CardTL:[function(e,t,i){"use strict";cc._RF.push(t,"8f29aoxhuNJOJY4vWRouOv0","CardTL");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=this&&this.__decorate||function(e,t,i,n){var r,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(o<3?r(a):o>3?r(t,i,a):r(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var a=e("../../../Scritps/Game/GAME_TYPE"),c=e("../../../Scritps/Windown"),s=cc._decorator,l=s.ccclass,d=s.property,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.imgBackground=null,t.imgValue=null,t.imgSuitSmall=null,t.imgSuitLarge=null,t.borderCard=null,t.bg_cardSmall=null,t.bkgMask=null,t.listFrameCard=null,t.card_border_blue=null,t.code=0,t.N=0,t.S=0,t.nameCard="",t.isSelect=!1,t.isTouch=!0,t}return r(t,e),t.prototype.start=function(){},t.prototype.setTextureWithCode=function(e,t,i,n){if(void 0===t&&(t=!1),void 0===i&&(i=!1),void 0===n&&(n=!1),this.code=e,this.code<=0||this.code>52)this.imgValue.node.active=!1,this.imgSuitSmall.node.active=!1,this.imgSuitLarge.node.active=!1,this.bg_cardSmall.active=!1,this.imgBackground.spriteFrame=this.listFrameCard.getSpriteFrame("card_back_red1");else{this.imgValue.node.active=!0,this.imgSuitSmall.node.active=!0,this.imgSuitLarge.node.active=!0,this.decodeCard(this.code),this.imgBackground.spriteFrame=this.listFrameCard.getSpriteFrame("card_bg");var r=this.getSuitInVN();this.imgValue.spriteFrame=this.listFrameCard.getSpriteFrame(cc.js.formatStr("card_%d",this.getValue())),this.imgSuitSmall.spriteFrame=this.listFrameCard.getSpriteFrame(cc.js.formatStr("card_%s_small",r)),this.N>=11&&this.N<=13?this.imgSuitLarge.spriteFrame=this.listFrameCard.getSpriteFrame(cc.js.formatStr("card_%d_%s",this.getValue(),r)):this.imgSuitLarge.spriteFrame=this.listFrameCard.getSpriteFrame(cc.js.formatStr("card_%s",r)),this.imgValue.node.color="tep"===r||"bich"===r?cc.Color.BLACK:cc.Color.RED,this.imgValue.type=cc.Sprite.Type.SIMPLE,this.imgValue.sizeMode=cc.Sprite.SizeMode.CUSTOM,this.imgSuitSmall.type=cc.Sprite.Type.SIMPLE,this.imgSuitSmall.sizeMode=cc.Sprite.SizeMode.CUSTOM,this.imgSuitLarge.type=cc.Sprite.Type.SIMPLE,this.imgSuitLarge.sizeMode=cc.Sprite.SizeMode.CUSTOM,this.imgValue.node.setContentSize(32,50),this.imgSuitSmall.node.setContentSize(38,34),this.imgSuitLarge.node.setContentSize(90,100),this.imgValue.node.setScale(1),this.imgSuitSmall.node.setScale(1),this.imgSuitLarge.node.setScale(1)}var o=this.bg_cardSmall.children[0].getComponent(cc.Sprite),a=this.bg_cardSmall.children[1].getComponent(cc.Sprite);o.spriteFrame=this.imgValue.spriteFrame,o.node.color=this.imgValue.node.color,a.spriteFrame=this.imgSuitSmall.spriteFrame,o.type=cc.Sprite.Type.SIMPLE,o.sizeMode=cc.Sprite.SizeMode.CUSTOM,a.type=cc.Sprite.Type.SIMPLE,a.sizeMode=cc.Sprite.SizeMode.CUSTOM,o.node.setContentSize(48.6,64.3),a.node.setContentSize(73,79.4),a.node.setPosition(10.5,-83.2)},t.prototype.encodeCard=function(){return 13*(this.S-1)+this.N-1},t.prototype.decodeCard=function(e){try{this.code=e,this.S=Math.floor((e-1)/13)+1,this.N=Math.floor((e-1)%13)+2,14===this.N&&c.Windown.GameView.gameType==a.default.Binh&&(this.N=1),this.nameCard=this.N+this.getSuitInVN()}catch(t){console.log(t)}},t.prototype.getSuitInVN=function(){switch(this.S){case 1:return"bich";case 2:return"tep";case 3:return"ro";case 4:return"co";default:return"joker"}},t.prototype.getValue=function(){return this.N>13?this.N-13:this.N},t.prototype.resetCard=function(){this.setBorder(!1)},t.prototype.setBorder=function(e){this.borderCard.node.active=e},t.prototype.moveCardNoBug=function(e,t){this.node.runAction(cc.moveTo(e,t).easing(cc.easeCubicActionOut()))},t.prototype.turnBorderBlue=function(e,t,i){void 0===t&&(t=1),void 0===i&&(i=1),this.card_border_blue.node.active=e,this.card_border_blue.node.setScale(t,i)},o([d(cc.Sprite)],t.prototype,"imgBackground",void 0),o([d(cc.Sprite)],t.prototype,"imgValue",void 0),o([d(cc.Sprite)],t.prototype,"imgSuitSmall",void 0),o([d(cc.Sprite)],t.prototype,"imgSuitLarge",void 0),o([d(cc.Sprite)],t.prototype,"borderCard",void 0),o([d(cc.Node)],t.prototype,"bg_cardSmall",void 0),o([d(cc.Node)],t.prototype,"bkgMask",void 0),o([d(cc.SpriteAtlas)],t.prototype,"listFrameCard",void 0),o([d(cc.Sprite)],t.prototype,"card_border_blue",void 0),o([l],t)}(cc.Component);i.default=h,cc._RF.pop()},{"../../../Scritps/Game/GAME_TYPE":void 0,"../../../Scritps/Windown":void 0}],LogicManagerTL:[function(e,t,i){"use strict";cc._RF.push(t,"c865axVbS9EGJZ7VqasZHET","LogicManagerTL");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=this&&this.__decorate||function(e,t,i,n){var r,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(o<3?r(a):o>3?r(t,i,a):r(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,c=a.ccclass,s=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var i;return r(t,e),i=t,t.checkDoiTL=function(e){return!(!i.checkDoi(e)||2!==e.length||e.length>0&&2==e[0].N)},t.checkXamTL=function(e){return!(!i.checkXam(e)||3!==e.length)},t.checkSanhTL=function(e){var t=e.slice();if(t.length<3)return!1;t.sort(function(e,t){return e.N-t.N});for(var i=0;i<t.length-1;i++)if(t[i].N+1!==t[i+1].N)return!1;return!0},t.ckeckThungPhaSanhTL=function(e){var t=e.slice();if(!this.checkSanhTL(t))return!1;for(var i=0;i<t.length-1;i++)if(t[i].S!==t[i+1].S)return!1;return!0},t.check2DoiThongTL=function(){return!1},t.check3DoiThongTL=function(e){var t=e.slice();if(6!==t.length)return!1;if(t.sort(function(e,t){return e.N-t.N}),t[0].N!=t[1].N)return!1;for(var i=0;i<t.length-2;i++)if(t[i].N+1!==t[i+2].N||2==t[i].N)return!1;return!0},t.check4DoiThongTL=function(e){var t=e.slice();if(8!==t.length)return!1;if(t.sort(function(e,t){return e.N-t.N}),t[0].N!=t[1].N)return!1;for(var i=0;i<t.length-2;i++)if(t[i].N+1!==t[i+2].N||2==t[i].N)return!1;return!0},t.checkHaiTL=function(e){var t=e.slice();return 1==t.length&&2==t[0].N},t.checkDoiHaiTL=function(e){var t=e.slice();if(2!=t.length)return!1;for(var i=0;i<t.length;i++)if(2!=t[i].N)return!1;return!0},t.checkTuQuy=function(e){var t=e.slice();if(t.sort(function(e,t){return e.N-t.N}),t.length<4)return!1;for(var i=0;i<t.length-1;i++){for(var n=0,r=i+1;r<t.length;r++)t[r].N===t[i].N&&n++;if(3===n)return!0}return!1},t.checkDoi=function(e){var t=e.slice();if(t.sort(function(e,t){return e.N-t.N}),t.length<2)return!1;for(var i=0;i<t.length-1;i++)if(t[i].N===t[i+1].N)return!0;return!1},t.checkXam=function(e){var t=e.slice();if(t.sort(function(e,t){return e.N-t.N}),t.length<3)return!1;for(var i=0;i<t.length-2;i++)if(t[i].N===t[i+1].N&&t[i+1].N===t[i+2].N)return!0;return!1},t.checkSetOfTwos=function(e){var t=e.slice();if(t.length>3||t.length<2)return!1;for(var i=0;i<t.length;i++)if(2!==t[i].N)return!1;return!0},i=o([c],t)}(cc.Component));i.default=s,cc._RF.pop()},{}],PlayerViewTL:[function(e,t,i){"use strict";cc._RF.push(t,"07d1c0ZZwNMsYgKK3OZf9na","PlayerViewTL");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=this&&this.__decorate||function(e,t,i,n){var r,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(o<3?r(a):o>3?r(t,i,a):r(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{s(n.next(e))}catch(t){o(t)}}function c(e){try{s(n.throw(e))}catch(t){o(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var i,n,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(e){return function(t){return s([e,t])}}function s(o){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(c){o=[6,c],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});var s=e("../../../Scritps/DefineTs/PathResource"),l=e("../../../Scritps/Windown"),d=cc._decorator,h=d.ccclass,u=d.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lbName=null,t.lbAg=null,t.imgAvatar=null,t.imgBack=null,t.imgTime=null,t.timeTurn=0,t.timeCurrentTurn=0,t.aniLose=null,t.aniWin=null,t.aniPhao=null,t.bkgThanhBar=null,t.listAnimItems=[],t.listSprItems=[],t.fontLb=[],t._isTurn=!1,t.idUser=0,t._indexDynamic=0,t.id=0,t.vectorCard=[],t.displayName="",t.numberCard=0,t.vectorCardD=[],t.ag=0,t.point=0,t.typeWin=-1,t.currentLevel=0,t}return r(t,e),t.prototype.start=function(){},t.prototype.cleanPlayerView=function(){this.vectorCard=[]},t.prototype.update=function(e){if(this._isTurn)if(this.timeCurrentTurn+=e,this.timeCurrentTurn<=this.timeTurn){this.imgTime.fillRange=(this.timeTurn-this.timeCurrentTurn)/this.timeTurn,this.imgTime.fillRange<=.25?this.imgTime.node.color=cc.Color.RED:this.imgTime.fillRange<=.5?this.imgTime.node.color=cc.Color.ORANGE:this.imgTime.node.color=cc.Color.WHITE;var t=-this.timeCurrentTurn*(360/this.timeTurn/180)*Math.PI,i=65*Math.cos(t),n=65*Math.sin(t);this.aniPhao.node.setPosition(cc.v2(i,n))}else this.imgTime.node.active=!1,this._isTurn=!1},t.prototype.effLbName=function(){if(this.lbName.node.stopAllActions(),this.lbName.node.setPosition(cc.v2(0,0)),cc.log("WIDTH LB NAME=="+this.lbName.node.width),2*this.lbName.node.width>this.lbName.node.parent.width-10){var e=(this.lbName.node.width-this.lbName.node.parent.width)/2,t=e/30,i=cc.moveTo(t,e/4,0),n=cc.moveTo(t,-e/4,0);if(cc.log("offset=="+e),t<1&&(t=1),e<3)return;this.lbName.node.anchorX=.5,this.lbName.node.runAction(cc.repeatForever(cc.sequence(cc.delayTime(1.5),i,cc.delayTime(1.5),n)))}},t.prototype.setPosThanhBarThisPlayer=function(){this.bkgThanhBar.setPosition(cc.v2(0,0)),this.bkgThanhBar.getComponent(cc.Sprite).enabled=!0,this.lbAg.fontSize=30,this.lbAg.node.parent.setPosition(cc.v2(-190,-25)),this.lbName.fontSize=30,this.lbName.node.parent.setPosition(cc.v2(-140,20))},t.prototype.setName=function(e){var t=this;null!==this.lbName&&(this.lbName.string=e),cc.log("Chay vao ham set name:"+e),this.scheduleOnce(function(){null!=t.node&&void 0!==t.node&&t.effLbName()},.5)},t.prototype.setAg=function(e){null!==this.lbAg&&(this.lbAg.string=this.formatMoney(e),this.lbAg.node.runAction(cc.sequence(cc.scaleTo(.1,1.2),cc.scaleTo(.1,1))))},t.prototype.setAvatar=function(e){this.imgAvatar.spriteFrame=e},t.prototype.setTurn=function(e,t,i,n){void 0===i&&(i=!1),void 0===n&&(n=null),this.imgTime&&this.imgTime.node&&(this.imgTime.node.active=e,this._isTurn=e,e&&(this.timeCurrentTurn=0,this.timeTurn=t,this.imgTime.fillRange=1))},t.prototype.onEnable=function(){this.aniWin.node.active=!1,this.aniLose.node.active=!1},t.prototype.onDisable=function(){this.setTurn(!1,0,!1,null),this.bkgThanhBar.setPosition(cc.v2(0,-70)),this.imgBack.node.active=!1},t.prototype.showEffectWinLose=function(e){var t,i=this;cc.log("Chay vao set EffectWinLose"),1===e?(this.aniWin.node.active=!0,this.aniWin.setSlotsToSetupPose(),this.aniWin.setAnimation(0,"appear",!1),this.aniWin.setCompleteListener(function(){i.aniWin.setAnimation(0,"idle",!0),i.aniWin.setCompleteListener(function(){i.aniWin.setCompleteListener(null)})}),t=this.aniWin.node):(this.aniLose.node.active=!0,this.aniLose.node.active=!0,this.aniLose.setSlotsToSetupPose(),this.aniLose.setAnimation(0,"appear",!1),this.aniLose.setCompleteListener(function(){i.aniLose.setAnimation(0,"idle",!0),i.aniLose.setCompleteListener(function(){i.aniLose.setCompleteListener(null)})}),t=this.aniLose.node),cc.Tween.stopAllByTarget(t),t.scaleX=1,cc.tween(t).delay(2).to(.2,{scaleX:0},{easing:cc.easing.backIn}).call(function(){t.active=!1}).start()},t.prototype.isTurn=function(){return this._isTurn},t.prototype.updateAg=function(e){this.lbAg.string=""+this.formatMoney(e),this.ag=e},t.prototype.updatePlayerView=function(e){var t=this;console.log("updatePlayerView:",e),this.lbName.string=e.nickname,this.scheduleOnce(function(){null!=t.node&&void 0!==t.node&&t.effLbName()},.5),this.lbAg.string=""+this.formatMoney(e.ag)},t.prototype.effectFlyMoney=function(e,t,i,n,r){if(void 0===t&&(t=25),void 0===i&&(i=50),void 0===n&&(n=0),void 0===r&&(r=0),cc.log("money la ",e),"number"==typeof e&&0!=e){var o="",a=null;if(e>=0?(o="+",a=this.fontLb[0]):(o="-",a=this.fontLb[1]),null!=this.node){var c=new cc.Node("TextFly"),s=c.addComponent(cc.Label);s.string=o+this.formatNumber(Math.abs(e)),s.fontSize=t,s.font=a,s.spacingX=-3,this.node.addChild(c,270),cc.tween(s.node).set({scaleX:0,opacity:0,y:60}).to(.2,{scaleX:1,opacity:255},{easing:cc.easing.backOut}).delay(1.8).to(.2,{scaleX:0,opacity:0},{easing:cc.easing.backIn}).call(function(){null!==s.node&&s.node.destroy()}).start()}}},t.prototype.formatMoney=function(e){var t=e<0,i="",n=Math.abs(e);if(e=Math.abs(e),n>=1e9)n/=1e9,i="B";else{if(!(n>=1e6))return(1==t?"-":"")+this.formatNumber(e);n/=1e6,i="M"}for(var r=e.toString()+"0",o=n.toString()+"a",a=0,c=0;c<r.length;c++)if(r[c]!==o[c]){a=c;break}return(1==t?"-":"")+Math.floor(n)+("0"===r.toString()[a]&&"0"===r.toString()[a+1]?"":",")+("0"===r.toString()[a]&&"0"===r.toString()[a+1]?"":r.toString()[a])+("0"===r.toString()[a+1]?"":r.toString()[a+1])+i.toUpperCase()},t.prototype.formatNumber=function(e,t){return void 0===t&&(t=3),e.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")},t.prototype.onClickPlayer=function(){return a(this,void 0,void 0,function(){var e,t;return c(this,function(i){switch(i.label){case 0:return[4,l.Windown.getPrefabRes(s.PathResource.InfoPlayerView)];case 1:return e=i.sent(),t=cc.instantiate(e),l.Windown.GameView.node.addChild(t,999),t.getComponent("InfoPlayerView").setInfo(this),[2]}})})},t.prototype.showBackExit=function(){this.imgBack.node.active=!this.imgBack.node.active},t.prototype.setBgAvatar=function(){this.node.getChildByName("ParentKhungVip")},t.prototype.clearState=function(){this.numberCard=0},t.prototype.clearVectorCardD=function(){for(var e=l.Windown.GameView.cardPool,t=0;t<this.vectorCardD.length;t++)e.put(this.vectorCardD[t].node);this.vectorCardD=[]},t.prototype.clearAllCard=function(){for(var e=0;e<this.vectorCard.length;e++)this.vectorCard[e].node.destroy();for(e=0;e<this.vectorCardD.length;e++)this.vectorCardD[e].node.destroy();this.vectorCard=[],this.vectorCardD=[]},o([u(cc.Label)],t.prototype,"lbName",void 0),o([u(cc.Label)],t.prototype,"lbAg",void 0),o([u(cc.Sprite)],t.prototype,"imgAvatar",void 0),o([u(cc.Sprite)],t.prototype,"imgBack",void 0),o([u(cc.Sprite)],t.prototype,"imgTime",void 0),o([u(cc.Integer)],t.prototype,"timeTurn",void 0),o([u(cc.Integer)],t.prototype,"timeCurrentTurn",void 0),o([u(sp.Skeleton)],t.prototype,"aniLose",void 0),o([u(sp.Skeleton)],t.prototype,"aniWin",void 0),o([u(sp.Skeleton)],t.prototype,"aniPhao",void 0),o([u(cc.Node)],t.prototype,"bkgThanhBar",void 0),o([u([sp.SkeletonData])],t.prototype,"listAnimItems",void 0),o([u([cc.SpriteFrame])],t.prototype,"listSprItems",void 0),o([u([cc.Font])],t.prototype,"fontLb",void 0),o([h],t)}(cc.Component);i.default=p,cc._RF.pop()},{"../../../Scritps/DefineTs/PathResource":void 0,"../../../Scritps/Windown":void 0}],TienLenGameView:[function(e,t,i){"use strict";cc._RF.push(t,"f3c4fzexQdMz6F3cU0qoZTZ","TienLenGameView");var n,r=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),o=this&&this.__decorate||function(e,t,i,n){var r,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(a=(o<3?r(a):o>3?r(t,i,a):r(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a},a=this&&this.__awaiter||function(e,t,i,n){return new(i||(i=Promise))(function(r,o){function a(e){try{s(n.next(e))}catch(t){o(t)}}function c(e){try{s(n.throw(e))}catch(t){o(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,c)}s((n=n.apply(e,t||[])).next())})},c=this&&this.__generator||function(e,t){var i,n,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(e){return function(t){return s([e,t])}}function s(o){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(c){o=[6,c],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},s=this&&this.__spreadArrays||function(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var n=Array(e),r=0;for(t=0;t<i;t++)for(var o=arguments[t],a=0,c=o.length;a<c;a++,r++)n[r]=o[a];return n};Object.defineProperty(i,"__esModule",{value:!0});var l=e("../../../Scritps/DefineTs/EVENT_MANAGER"),d=e("../../../Scritps/DefineTs/PathResource"),h=e("../../../Scritps/DefineTs/REQUEST_CODE"),u=e("../../../Scritps/DefineTs/TextDefine"),p=e("../../../Scritps/Game/GAME_TYPE"),f=e("../../../Scritps/Network/ConectManager"),g=e("../../../Scritps/Other/MakeDelay"),v=e("../../../Scritps/Windown"),y=e("./AudioTL"),C=e("./LogicManagerTL"),S=e("./PlayerViewTL"),m=cc._decorator,b=m.ccclass,T=m.property,P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.lbInfo=null,t.listPosView=[],t.listPosCard=[],t.listPosCardDanh=[],t.btnMenu=null,t.btnQuickChat=null,t.btnPass=null,t.btnDiscard=null,t.lbDiscard=null,t.btnSort=null,t.lbTimeStart=null,t.lbNumberCard=[],t.listSpritePass=[],t.listBgScore=[],t.listLbScore=[],t.bgHint=null,t.lbHint=null,t.timerControl=null,t.vtChipFinish=[],t.vtChipDenLang=[],t.listDataPlayerResult=[],t.aniCardSpecial=null,t.aniWinSpecial=null,t.aniStartGame=null,t.aniFinish=null,t.aniChayBai=[],t.lbNameWin=null,t.avtSpecial=null,t.sprWinSpectical=null,t.listSprTextWinSpectical=[],t.icon_chips=null,t.prefabsPlayerView=null,t.cardPrefab=null,t.audio=null,t.thisPlayer=null,t.currenPlayer=null,t.players=[],t.cardSelect=null,t.listCardSuggest=[],t.numCardSelect=0,t.posDefaultCard=cc.v2(0,0),t.posTouchBegan=cc.v2(0,0),t.zOrderCard=0,t.sizeCardW=0,t.zIndexCardD=0,t.touched=!1,t.dangPhatBai=!1,t.turnIdCurrent=0,t.lastTurnId=0,t.timeToStart=0,t.timeTurn=0,t.typeSort=0,t.playerSpecail=null,t.stateGame=0,t.cardPool=null,t.isFinish=!1,t.gameType=-1,t.sfs=null,t.roomSFS=null,t.funEnd=null,t.dataFinish=null,t.sfsObjTest=null,t.sfsObjTest2=null,t.makeDelay=null,t.indexFunc=0,t.markCurrent=0,t.roomIdCurrent=0,t.passRoomCurrent="",t.isAllowClickDownAllCard=!1,t.cardSelectNumberOne=null,t.resultSuggest=[],t.listEvt=[],t}return r(t,e),t.prototype.onLoad=function(){this.node.setContentSize(cc.winSize);var e=this.getComponent(cc.Sprite);e&&(e.sizeMode=0),cc.sys.localStorage.setItem("isBack",!1),this.cardPool=new cc.NodePool("Card");var t=this.getCard();this.sizeCardW=t.node.getContentSize().width,this.initLoad(),this.initInviteNode(),v.Windown.TienLen=this,v.Windown.GameView=this,this.makeDelay=new g.default(this),console.log("start"),this.gameType=p.default.TienLen,this.sfs=f.ConectManager.getIns().sfs,this.sfs.addEventListener(SFS2X.SFSEvent.USER_EXIT_ROOM,this.userExitRoom,this),this.sfs.addEventListener(SFS2X.SFSEvent.ROOM_CREATION_ERROR,this.onCreateError,this),this.sfs.addEventListener(SFS2X.SFSEvent.ROOM_JOIN_ERROR,this.onJoinRoomErr,this),this.sfs.addEventListener(SFS2X.SFSEvent.ROOM_JOIN,this.onJoinRoom,this),this.sfs.addEventListener(SFS2X.SFSEvent.EXTENSION_RESPONSE,this.extResponse,this),cc.systemEvent.on(l.EVENT_MANAGER.LOGIN,this.onLogin,this),cc.systemEvent.on(l.EVENT_MANAGER.onDisconnect,this.onDisconnect,this)},t.prototype.onLogin=function(){this.sendJoinRoom(this.roomIdCurrent,this.passRoomCurrent),this.sendGetInfoRoomReconnect()},t.prototype.handleAutoExit=function(e){var t=JSON.parse(e);if(t.status){var i=this.getPlayerWithId(t.id);if(null==i||void 0===i)return;return t.id===v.Windown.User.userId?(cc.sys.localStorage.setItem("isBack",!1),void cc.director.loadScene("main")):(this.removePlayer(t.id),void this.setTimeStart(0))}return-1==t.type?(this.thisPlayer.showBackExit(),void v.Windown.Dialog.showLog("B\u1ea1n \u0111ang trong b\xe0n!")):(this.thisPlayer.showBackExit(),void v.Windown.Dialog.showLog("Kh\xf4ng th\u1ec3 chuy\u1ec3n b\xe0n cho t\u1edbi khi v\xe1n ch\u01a1i k\u1ebft th\xfac!"))},t.prototype.removePlayer=function(e,t){void 0===t&&(t=!1);var i=this.getPlayerWithId(e);null!==i&&(this.players.splice(this.players.indexOf(i),1),i.node.destroy(),i=null,t||this.updatePositionPlayerView())},t.prototype.getMakeDelay=function(e){return this.makeDelay.getDelay(e)},t.prototype.onDestroy=function(){cc.systemEvent.removeAll(this),this.roomSFS=null,this.sfs.removeEventListener(SFS2X.SFSEvent.USER_EXIT_ROOM,this.userExitRoom),this.sfs.removeEventListener(SFS2X.SFSEvent.ROOM_CREATION_ERROR,this.onCreateError),this.sfs.removeEventListener(SFS2X.SFSEvent.ROOM_JOIN,this.onJoinRoom),this.sfs.removeEventListener(SFS2X.SFSEvent.ROOM_JOIN_ERROR,this.onJoinRoomErr),this.sfs.removeEventListener(SFS2X.SFSEvent.EXTENSION_RESPONSE,this.extResponse),v.Windown.GameView=null,v.Windown.TienLen=null},t.prototype.sendJoinRoom=function(e,t){v.Windown.UIManager.showLoading(),cc.log("send join room");try{f.ConectManager.getIns().sendJoinRoom(e,t),this.roomIdCurrent=e,this.passRoomCurrent=t}catch(i){cc.error(i),this.onDisconnect()}},t.prototype.sendGetInfoRoom=function(e){var t=f.ConectManager.getIns().getSFSObj();t.putInt("roomType",0),t.putInt("gameType",p.default.TienLen),t.putInt("mark",e),f.ConectManager.getIns().sendRequest(h.REQUEST_CODE.GetIdJoinRoom,t),cc.systemEvent.once(h.REQUEST_CODE.GetIdJoinRoom,function(e){var t=e.get("idRoom");cc.log("roomId getInfo "+t)},this)},t.prototype.onDisconnect=function(){cc.log("disconnect"),v.Windown.UIManager.hideLoading(),v.Windown.UIManager.hideLoadingData(),cc.director.loadScene("main"),v.Windown.LobbyView&&(v.Windown.LobbyView.node.active=!1)},t.prototype.userExitRoom=function(e){if("TE"==e.room.groupId){var t=e.user;if(cc.log("user exit room: ",t),t.isItMe)return void cc.director.loadScene("main")}},t.prototype.onCreateError=function(){cc.log("creat errr"),v.Windown.UIManager.hideLoading(),cc.director.loadScene("main"),v.Windown.Dialog.showLog(u.TextDefine.ERR_JOIN_ROOM)},t.prototype.onJoinRoom=function(e){cc.log("onJoinRoom tienLen");var t=e.room;if("TE"==t.groupId){this.roomSFS=t,v.Windown.UIManager.hideLoading(),v.Windown.UIManager.hideLoadingData();var i=t.getVariable("cf").value;cc.log("no vao room nay: "+i)}},t.prototype.onJoinRoomErr=function(){cc.log("onJoinRoomErr "),v.Windown.UIManager.hideLoading(),v.Windown.UIManager.hideLoadingData(),v.Windown.Dialog.showLog(u.TextDefine.ERR_JOIN_ROOM),cc.director.loadScene("main")},t.prototype.extResponse=function(e){var t=e.cmd,i=e.params,n=v.Windown.SFSObjToJson(i);switch(t){case"infoRoomTL":cc.log("extResponse infoRoom:",n),this.handleInfoRoom(n);break;case"st":cc.log("extResponse st:",n),this.handleStartTime(n);break;case"lc":cc.log("extResponse Lc:",n),this.handleLc(n);break;case"uj":cc.log("extResponse Uj:",n),this.handleUserJoin(n);break;case"dc":cc.log("extResponse dc:",n),this.handleDc(n);break;case"pa":cc.log("extResponse pass:",n),this.handlePass(n);break;case"finish":cc.log("extResponse finish:",n),this.handleFinish(n);break;case"autoExit":cc.log("extResponse autoExit:",n),this.handleAutoExit(n);break;case"chat":cc.log("extResponse chat:",n),this.handleChat(n);break;case"chatI":cc.log("extResponse chat:",n),this.handleChatI(n)}},t.prototype.initInviteNode=function(){var e=this;cc.loader.loadRes("inviteBtn",function(t,i){if(t)cc.log(t);else{if(null==e.node)return;for(var n=1;n<e.listPosView.length;n++)if(null!=e.listPosView[n]){var r=cc.instantiate(i).getComponent(cc.Button);r.node.setPosition(e.listPosView[n]),e.node.addChild(r.node,1);var o=new cc.Component.EventHandler;o.target=e.node,o.component="TienLenGameView",o.handler="onClickInvite",o.customEventData="",r.clickEvents.push(o)}}})},t.prototype.initLoad=function(){var e=this,t=this.listPosCard[0],i=this.getCard();this.sizeCardW=i.node.getContentSize().width,this.isFinish=!1;for(var n=0;n<4;n++)this.lbNumberCard[n].node.zIndex=70,this.lbNumberCard[n].node.active=!1,this.listBgScore[n].node.active=!1,this.aniChayBai[n].node.active=!1,this.aniChayBai[n].node.zIndex=200;this.btnSort.node.active=!1,this.btnPass.node.active=!1,this.btnDiscard.node.active=!1,this.bgHint.node.active=!1,this.aniCardSpecial.node.active=!1,this.aniCardSpecial.timeScale=1,this.aniCardSpecial.node.zIndex=200,this.aniWinSpecial.node.active=!0,this.aniWinSpecial.node.zIndex=200,this.aniFinish.node.active=!1,this.aniFinish.animation="finish",this.aniFinish.node.zIndex=1111,this.aniStartGame.node.active=!1,this.aniStartGame.node.zIndex=1111,this.typeSort=2,this.isAllowClickDownAllCard=!1,this.node.setContentSize(cc.winSize),this.node.on(cc.Node.EventType.TOUCH_START,function(t){if(cc.log("ON TOUCH BEGAN"),!(e.touched||e.isFinish||e.dangPhatBai)&&e.thisPlayer&&1===e.stateGame){e.posTouchBegan=cc.v2(t.getLocation());for(var i=e.thisPlayer.vectorCard.length-1;i>=0;i--){var n=e.thisPlayer.vectorCard[i];if(n.node.getBoundingBoxToWorld().contains(e.posTouchBegan)&&n.isTouch){e.cardSelect=n,e.posDefaultCard=n.node.getPosition(),e.zOrderCard=n.node.zIndex,e.touched=!0;var r=n.node.position;n.node.runAction(cc.sequence(cc.delayTime(.2),cc.spawn(cc.scaleTo(.2,1.1).easing(cc.easeCubicActionOut()),cc.moveTo(.2,cc.v2(r.x,-260))))),cc.log("=======click card th\u1ee9 %d ",e.zOrderCard-50);for(var o=i-2;o<=i+2;o++)o>=0&&o<e.thisPlayer.vectorCard.length&&i!=o&&(o==i-1||o==i+1?e.thisPlayer.vectorCard[o].node.runAction(cc.sequence(cc.delayTime(.2),cc.scaleTo(.2,1.08).easing(cc.easeCubicActionOut()))):e.thisPlayer.vectorCard[o].node.runAction(cc.sequence(cc.delayTime(.2),cc.scaleTo(.2,1).easing(cc.easeCubicActionOut()))));return}}}},this),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(i){if(e.touched&&!e.isFinish&&e.thisPlayer&&1===e.stateGame){for(var n=e.thisPlayer.vectorCard.length/2,r=cc.v2(i.getLocation()),o=0,a=0;a<e.thisPlayer.vectorCard.length;a++)if(e.thisPlayer.vectorCard[a]===e.cardSelect){o=a;break}var c=.4675*e.sizeCardW;if(e.thisPlayer.vectorCard.length%2==0)var s=t.x-c*(n+1);else s=t.x-c*n;var l=t.x+c*n,d=e.posDefaultCard.x+r.x-e.posTouchBegan.x,h=t.y;if(d>l&&(d=l),d<s&&(d=s),e.cardSelect.node.x=d,e.posTouchBegan.sub(r).mag()>=.25*e.sizeCardW){var u=o+1;if(u<e.thisPlayer.vectorCard.length&&(g=e.thisPlayer.vectorCard[u]).node.position.x<d){e.cardSelect.node.zIndex=g.node.zIndex;var p=g.node.position.x-c;g.node.runAction(cc.moveTo(.2,cc.v2(p,h)).easing(cc.easeCubicActionOut())),g.node.zIndex=e.cardSelect.node.zIndex-1;var f=e.thisPlayer.vectorCard[o];e.thisPlayer.vectorCard[o]=e.thisPlayer.vectorCard[u],e.thisPlayer.vectorCard[u]=f,o++,e.macBookCard(o)}var g,v=o-1;if(v>=0&&(g=e.thisPlayer.vectorCard[v]).node.position.x>d){e.cardSelect.node.zIndex=g.node.zIndex;var y=g.node.getPosition().x+c;g.node.runAction(cc.moveTo(.2,cc.v2(y,h)).easing(cc.easeCubicActionOut())),g.node.zIndex=e.cardSelect.node.zIndex+1,f=e.thisPlayer.vectorCard[o],e.thisPlayer.vectorCard[o]=e.thisPlayer.vectorCard[v],e.thisPlayer.vectorCard[v]=f,o--,e.macBookCard(o)}for(var C=0;C<e.thisPlayer.vectorCard.length;C++)e.thisPlayer.vectorCard[C]}}else e.cardSelect=null},this),this.node.on(cc.Node.EventType.TOUCH_END,function(i){if(cc.log("ON TOUCH ENDED"),e.touched&&!e.isFinish&&e.thisPlayer&&1===e.stateGame){e.touched=!1;var n=cc.v2(i.getLocation());if(e.posTouchBegan.sub(n).mag()<=.2*e.sizeCardW){if(0===e.numCardSelect&&(e.cardSelectNumberOne=e.cardSelect),0===e.numCardSelect&&0!==e.lastTurnId){e.suggestOnTouch(e.cardSelect,e.lastTurnId);for(var r=0;r<e.listCardSuggest.length;r++)for(var o=0;o<e.thisPlayer.vectorCard.length;o++){var a=e.thisPlayer.vectorCard[o];if(e.listCardSuggest[r]===a){var c=a.node.position.x;a.node.runAction(cc.scaleTo(.4,.85).easing(cc.easeCubicActionOut())),a.node.runAction(cc.moveTo(.2,cc.v2(c,t.y+30)).easing(cc.easeCubicActionOut())),a.isSelect=!0,e.numCardSelect++,e.numCardSelect>e.thisPlayer.vectorCard.length&&(e.numCardSelect=e.thisPlayer.vectorCard.length)}}}else if(1===e.numCardSelect)if(console.error("Cam la thu 2"),e.resultSuggest=[],c=e.posDefaultCard.x,e.cardSelect.isSelect)e.cardSelect.node.runAction(cc.scaleTo(.4,.85).easing(cc.easeCubicActionOut())),e.cardSelect.node.runAction(cc.moveTo(.2,cc.v2(c,t.y)).easing(cc.easeCubicActionOut())),e.cardSelect.isSelect=!1,e.numCardSelect--,e.numCardSelect<=0&&(e.numCardSelect=0);else{var s=e.thisPlayer.vectorCard.slice(),l=[];for(e.findStraightCard(s).forEach(function(e){return l.push(e)}),e.findTuQuy(s).forEach(function(e){l.push(e)}),e.findFourPairs(s).forEach(function(e){l.push(e)}),e.findThreePairs(s).forEach(function(e){l.push(e)}),e.findThreeCards(s).forEach(function(e){l.push(e)}),e.findTwoPairs(s).forEach(function(e){l.push(e)}),console.error("allResult==="+l.length),r=0;r<e.thisPlayer.vectorCard.length;r++)if((a=e.thisPlayer.vectorCard[r])!==e.cardSelect&&a.isSelect){e.cardSelectNumberOne=a;break}for(e.resultSuggest=e.findContainsTwoCardSelected(l,e.cardSelectNumberOne,e.cardSelect),console.error("Boc2la: ",e.resultSuggest),r=0;r<e.resultSuggest.length;r++)for(o=0;o<e.thisPlayer.vectorCard.length;o++)if(a=e.thisPlayer.vectorCard[o],e.resultSuggest[r]===a){var d=a.node.position.x;a.node.runAction(cc.scaleTo(.4,.85).easing(cc.easeCubicActionOut())),a.node.runAction(cc.moveTo(.2,cc.v2(d,t.y+30)).easing(cc.easeCubicActionOut())),a.isSelect=!0,e.numCardSelect++,e.numCardSelect>e.thisPlayer.vectorCard.length&&(e.numCardSelect=e.thisPlayer.vectorCard.length)}e.cardSelect.node.stopAllActions(),e.cardSelect.node.runAction(cc.scaleTo(.4,.85).easing(cc.easeCubicActionOut())),e.cardSelect.node.runAction(cc.moveTo(.2,cc.v2(c,t.y+30)).easing(cc.easeCubicActionOut())),e.cardSelect.isSelect=!0,e.numCardSelect++,e.numCardSelect>e.thisPlayer.vectorCard.length&&(e.numCardSelect=e.thisPlayer.vectorCard.length)}else c=e.posDefaultCard.x,e.cardSelect.isSelect?(e.cardSelect.node.runAction(cc.scaleTo(.4,.85).easing(cc.easeCubicActionOut())),e.cardSelect.node.runAction(cc.moveTo(.2,cc.v2(c,t.y)).easing(cc.easeCubicActionOut())),e.cardSelect.isSelect=!1,e.numCardSelect--,e.numCardSelect<=0&&(e.numCardSelect=0)):(e.cardSelect.node.runAction(cc.scaleTo(.4,.85).easing(cc.easeCubicActionOut())),e.cardSelect.node.runAction(cc.moveTo(.2,cc.v2(c,t.y+30)).easing(cc.easeCubicActionOut())),e.cardSelect.isSelect=!0,e.numCardSelect++,e.numCardSelect>e.thisPlayer.vectorCard.length&&(e.numCardSelect=e.thisPlayer.vectorCard.length));return cc.log("-=-=-=--==-=-==--==-=> Tienlen numCardSelect",e.numCardSelect),void e.sortCardSelect()}e.cardSelect=null,e.windowCard(),e.sortCardView()}else e.cardSelect=null},this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(i){if(cc.log("ON TOUCH CANCEL"),e.touched&&!e.isFinish&&e.thisPlayer&&1===e.stateGame){e.touched=!1;var n=cc.v2(i.getLocation());if(e.posTouchBegan.sub(n).mag()<=.25*e.sizeCardW){if(0===e.numCardSelect&&0!==e.lastTurnId){e.suggestOnTouch(e.cardSelect,e.lastTurnId);for(var r=0;r<e.listCardSuggest.length;r++)for(var o=0;o<e.thisPlayer.vectorCard.length;o++){var a=e.thisPlayer.vectorCard[o];if(e.listCardSuggest[r]===a){var c=a.node.position.x;a.node.runAction(cc.scaleTo(.4,.85).easing(cc.easeCubicActionOut())),a.node.runAction(cc.moveTo(.2,cc.v2(c,t.y+30)).easing(cc.easeCubicActionOut())),a.isSelect=!0,e.numCardSelect++,e.numCardSelect>e.thisPlayer.vectorCard.length&&(e.numCardSelect=e.thisPlayer.vectorCard.length)}}}else{var s=e.posDefaultCard.x;e.cardSelect.isSelect?(e.cardSelect.node.runAction(cc.scaleTo(.4,.85).easing(cc.easeCubicActionOut())),e.cardSelect.node.runAction(cc.moveTo(.2,cc.v2(s,t.y)).easing(cc.easeCubicActionOut())),e.cardSelect.isSelect=!1,e.numCardSelect--,e.numCardSelect<=0&&(e.numCardSelect=0)):(e.cardSelect.node.runAction(cc.scaleTo(.4,.85).easing(cc.easeCubicActionOut())),e.cardSelect.node.runAction(cc.moveTo(.2,cc.v2(s,t.y+30)).easing(cc.easeCubicActionOut())),e.cardSelect.isSelect=!0,e.numCardSelect++,e.numCardSelect>e.thisPlayer.vectorCard.length&&(e.numCardSelect=e.thisPlayer.vectorCard.length))}return cc.log("-=-=-=--==-=-==--==-=> Tienlen numCardSelect",e.numCardSelect),void e.sortCardSelect()}e.cardSelect=null,e.sortCardView(),e.windowCard()}else e.cardSelect=null},this)},t.prototype.sortCardView=function(){var e=this;cc.log("!> sort card view"),this.dangPhatBai=!0;for(var t,i=Math.round(this.thisPlayer.vectorCard.length/2*-1),n=function(e){var n=r.thisPlayer.vectorCard[e];n.node.stopAllActions(),n.node.runAction(cc.scaleTo(.2,.85).easing(cc.easeCubicActionOut())),n.node.zIndex=50+e,n.node.opacity=255,t=r.listPosCard[0].add(cc.v2(.4675*r.sizeCardW*i,0));var o=cc.moveTo(.1,t).easing(cc.easeCubicActionInOut()),a=cc.sequence(o,cc.callFunc(function(){n.isTouch=!0,n.isSelect=!1}));n.node.runAction(a),i++},r=this,o=0;o<this.thisPlayer.vectorCard.length;o++)n(o);this.node.runAction(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){e.dangPhatBai=!1}))),this.numCardSelect=0},t.prototype.sortCardSelect=function(){var e=this;cc.log("!> sort card select");var t=Math.round(this.thisPlayer.vectorCard.length/2*-1);this.numCardSelect=0,this.dangPhatBai=!0;for(var i,n=function(e){var n=r.thisPlayer.vectorCard[e];n.node.stopAllActions(),n.node.zIndex=50+e,n.node.opacity=255,n.isSelect?(i=r.listPosCard[0].add(cc.v2(.4675*r.sizeCardW*t,30)),r.numCardSelect++):i=r.listPosCard[0].add(cc.v2(.4675*r.sizeCardW*t,0));var o=cc.moveTo(.1,i).easing(cc.easeCubicActionInOut()),a=cc.sequence(o,cc.callFunc(function(){n.isTouch=!0}));n.node.runAction(a),t++},r=this,o=0;o<this.thisPlayer.vectorCard.length;o++)n(o);this.windowCard(),this.node.runAction(cc.sequence(cc.delayTime(.01),cc.callFunc(function(){e.dangPhatBai=!1})))},t.prototype.initPrefabs=function(e){return a(this,void 0,void 0,function(){var t,i;return c(this,function(n){switch(n.label){case 0:return[4,v.Windown.loadRes(this.gameType.toString(),"Prefabs/"+e,cc.Prefab)];case 1:return t=n.sent(),(i=cc.instantiate(t)).parent=v.Windown.GameView.node,[2,i]}})})},t.prototype.readDataPlayer=function(e,t){e.id=t.id,e.displayName=t.nickname,e.info=t,e.idUser=t.id,e.ag=t.ag,e.currentLevel=t.clv,e.currentLevel>5&&(e.currentLevel=5),e.setBgAvatar()},t.prototype.handleInfoRoom=function(e){v.Windown.LobbyView&&(v.Windown.LobbyView.node.active=!1);var t=JSON.parse(e).data;this.markCurrent=t.mark,this.roomIdCurrent=t.idRoom,console.log("Ctable: ",t),t.isPass?this.lbInfo.string="ID: "+t.idRoom+"\nBet: "+v.Windown.formatNumber(t.mark):this.lbInfo.string="Bet: "+v.Windown.formatNumber(t.mark);for(var i=t.listUser,n=!0,r=0;r<i.length;r++){var o=cc.instantiate(this.prefabsPlayerView).getComponent("PlayerViewTL");this.players.push(o),this.node.addChild(o.node,9),this.readDataPlayer(o,i[r].info),o.updatePlayerView(i[r].info),v.Windown.updateAvatar(v.Windown.ObjToSFSObj(i[r].info),o.imgAvatar),o.id===v.Windown.User.userId&&(cc.log("ko phai la viewing"),this.thisPlayer=o,n=!1),o.setTurn(!0,0,!1,null)}if(this.stateGame=1,n){o=cc.instantiate(this.prefabsPlayerView).getComponent("PlayerViewTL"),cc.log("viewing: ",v.Windown.SFSObjToJson(v.Windown.SFSInfouser)),this.stateGame=2,this.node.addChild(o.node,99),this.thisPlayer=o,this.players.push(o);var a={ag:v.Windown.User.userAg,clv:v.Windown.User.currentLevel,currentlevelpoint:v.Windown.User.currentLevelPoint,currentvippoint:v.Windown.User.currentVipPoint,id:v.Windown.User.userId,iv:v.Windown.User.avatrId,isFirtLogin:v.Windown.User.isFirtLogin,isFirtNap:v.Windown.User.isFirtNap,isPlayNow:v.Windown.User.isPlayNow,nn:v.Windown.User.nickName,phonenumber:v.Windown.User.phoneNumber,status:v.Windown.User.status,totallevelpoint:v.Windown.User.totalLevelPoint,tv:v.Windown.User.typeAvarta,username:v.Windown.User.userName};this.readDataPlayer(o,a),o.updatePlayerView(a),v.Windown.updateAvatar(v.Windown.ObjToSFSObj(a),o.imgAvatar),o.setTurn(!1,0,!1,null)}this.updatePositionPlayerView(),cc.log("!> rj",t),t.startGame&&this.connectGame(t)},t.prototype.connectGame=function(e){for(var t=e.listUser,i=0;i<t.length;i++)for(var n=this.getPlayerWithId(t[i].info.id),r=0;r<t[i].cards.length;r++)(a=this.getCard()).decodeCard(t[i].cards[r]),n.vectorCard.push(a);this.turnIdCurrent=e.idCurr,this.lastTurnId=e.idlw,this.timeTurn=10;var o=this.getPlayerWithId(e.idlw);if(o)for(i=0;i<e.cardsOut.length;i++){var a;(a=this.getCard()).decodeCard(e.cardsOut[i]),o.vectorCardD.push(a)}this.initPlayerCard(e),this.getPlayerWithId(e.idCurr).setTurn(!0,e.time,!0,null)},t.prototype.initPlayerCard=function(e){1===this.stateGame&&(cc.log("--=-=-==-=--=-=-=-=-=-=-=>>>>>>> Tienlen v\xe0o \u0111\xe2y ch\u01b0a em \u01a1i"),this.btnSort.node.active=!0,this.btnSort.enabled=!0,this.btnSort.interactable=!0,cc.log("--=-=-==-=--=-=-=-=-=-=-=>>>>>>> Tienlen ten palyer cu ->>>"+this.turnIdCurrent),e.idCurr===this.thisPlayer.id&&(this.btnPass.node.active=!0,this.btnDiscard.node.active=!0,this.btnPass.enabled=!0,this.btnDiscard.enabled=!0,this.btnPass.interactable=!0,this.btnDiscard.interactable=!0));var t=Math.round(this.thisPlayer.vectorCard.length/2*-1);cc.log("=-=-=-=-=--=-=-=-=-==--=-=-=-=-=-=-==> Tienlen index : "+t);for(var i=0;i<this.players.length;i++){var n=this.players[i];if(n!==this.thisPlayer||2!==this.stateGame){var r=n.vectorCard.length,o=n.vectorCardD.length;n.numberCard=r;var a=n._indexDynamic,c=this.listPosCard[a],s=this.listPosCardDanh[a];0===a||2===a?s=s.sub(cc.v2(.275*this.sizeCardW*o/2,0)):1===a&&(s=s.sub(cc.v2(.275*this.sizeCardW*o,0)));for(var l=0;l<r;l++)if((h=n.vectorCard[l]).node.active=!0,this.node.addChild(h.node,50+l),h.setTextureWithCode(h.code),n===this.thisPlayer){cc.log("==----------------=============>>> Tienlen abc "+.4675*this.sizeCardW*t);var d=this.listPosCard[0].add(cc.v2(.4675*this.sizeCardW*t,0));h.node.setScale(.85),h.node.setPosition(d.x,d.y),cc.log("--=-=-=-=-=-=-=-=-=-=--=-=-=-=-=-=>>>>>>> Tienlen poscard: "+d),t++,cc.log("=-=-=-=-=--=-=-=-=-==--=-=-=-=-=-=-==> Tienlen index : "+t)}else h.node.setScale(.5),h.node.setPosition(c.x,c.y);for(n!==this.thisPlayer&&n.numberCard>0&&(this.lbNumberCard[a].string=n.numberCard.toString(),this.lbNumberCard[a].node.active=!0),l=0;l<n.vectorCardD.length;l++){var h=n.vectorCardD[l];s=s.add(cc.v2(.225*this.sizeCardW,0)),h.node.active=!0,this.node.addChild(h.node,50+l),h.setTextureWithCode(h.code),h.node.setScale(.5),h.node.setPosition(s.x,s.y)}}}1===this.stateGame&&this.onClickSortCard()},t.prototype.initPlayerView=function(){},t.prototype.handleLc=function(e){return a(this,void 0,void 0,function(){var t,i,n,r,o,a,s,l=this;return c(this,function(){for(t=JSON.parse(e),this.audio.playEffect(this.audio.startGame),this.beforeStartGame(),this.aniStartGame.node.active=!0,this.aniStartGame.setAnimation(0,"startgame",!1),i=JSON.parse(t.arr),this.timeTurn=t.time,this.turnIdCurrent=t.idTurn,n=t.firstRound,r=0;r<this.players.length;r++){for((o=this.players[r]).vectorCard=[],a=0;a<i.length;a++)(s=this.getCard()).node.setScale(.5),s.setTextureWithCode(0),s.node.active=!1,this.node.addChild(s.node,50-a),s.node.setPosition(0,0),o===this.thisPlayer&&s.decodeCard(i[a]),o.vectorCard.push(s);o===this.thisPlayer?o.numberCard=13:o.numberCard=0}return cc.tween(this.node).delay(1).call(function(){l.dealCard()}).delay(2.8).call(function(){if(l.dangPhatBai=!1,l.onClickSortCard(),l.getPlayerWithId(t.idTurn).setTurn(!0,t.time,!0,null),l.turnIdCurrent===l.thisPlayer.id&&n){l.bgHint.node.active=!0;var e=cc.scaleTo(.25,1.1),i=cc.scaleTo(.25,.9),r=cc.sequence(e,i),o=cc.repeat(r,6);l.bgHint.node.runAction(cc.sequence(o,cc.callFunc(function(){l.bgHint.node.active=!1})))}l.turnIdCurrent===l.thisPlayer.id&&(l.btnDiscard.node.active=!0,l.btnDiscard.enabled=!0,l.btnDiscard.interactable=!0,l.btnDiscard.node.setPosition(cc.v2(0,l.btnDiscard.node.position.y)),l.lbDiscard.string="\u0110\xe1nh B\xe0i"),l.btnSort.node.active=!0,l.btnSort.enabled=!0,l.btnSort.interactable=!0}).delay(1).call(function(){l.isAllowClickDownAllCard=!0}).start(),[2]})})},t.prototype.dealCard=function(){var e=this;this.aniStartGame.node.active=!1,this.dangPhatBai=!0;for(var t,i,n,r=function(r){var a=o.players[r],c=a._indexDynamic;t=o.listPosCard[c],i=0,n=-6;for(var s=function(r){var s=a.vectorCard[r];if(s.node.active=!0,s.node.angle=-90,a===o.thisPlayer){t=o.listPosCard[0].add(cc.v2(.4675*o.sizeCardW*n,0));var l=cc.moveTo(.4,t).easing(cc.easeCubicActionOut()),d=cc.scaleTo(.4,.85).easing(cc.easeCubicActionOut()),h=cc.rotateTo(.4,0).easing(cc.easeCubicActionOut()),u=cc.callFunc(function(){s.node.zIndex=50+r}),p=cc.spawn(l,u,d,h),f=cc.spawn(cc.scaleTo(.15,0,.85),cc.skewTo(.15,0,-20)),g=cc.spawn(cc.scaleTo(.15,.85,.85),cc.skewTo(.15,0,0));s.node.runAction(cc.sequence(cc.delayTime(i),p,f,cc.callFunc(function(){e.audio.playEffect(e.audio.dichuyenLabai),s.setTextureWithCode(s.code),s.node.skewY=20}),g)),n++}else l=cc.moveTo(.2,t).easing(cc.easeCubicActionInOut()),u=cc.callFunc(function(){s.node.zIndex=50+r}),h=cc.rotateTo(.4,0).easing(cc.easeCubicActionOut()),p=cc.spawn(l,u,h),s.node.runAction(cc.sequence(cc.delayTime(i),p,cc.callFunc(function(){a.numberCard++,e.lbNumberCard[c].string=a.numberCard.toString(),e.lbNumberCard[c].node.active=!0})));i+=.15},l=0;l<a.vectorCard.length;l++)s(l)},o=this,a=0;a<this.players.length;a++)r(a)},t.prototype.beforeStartGame=function(){this.stateGame=1,this.typeSort=2,this.turnIdCurrent=0,this.lastTurnId=0,this.playerSpecail=null,this.listCardSuggest=[],this.isFinish=!1,this.zIndexCardD=60;for(var e=0;e<this.players.length;e++)this.players[e].clearState();this.updatePositionPlayerView()},t.prototype.handleStartTime=function(e){return a(this,void 0,void 0,function(){var t;return c(this,function(){return t=JSON.parse(e),console.log("st: ",t),this.cleanTable(),this.setTimeStart(t.time),[2]})})},t.prototype.setTimeStart=function(e){var t=this;if(null!==this.timerControl){this.timerControl.stopAllActions(),this.timerControl.active=!0;var i=cc.delayTime(1),n=cc.callFunc(function(){e>0?(t.timerControl.getChildByName("lbTimeStart").getComponent(cc.Label).string=""+e,e--):t.timerControl.active=!1}),r=cc.sequence(n,i),o=cc.repeatForever(r);this.timerControl.runAction(o)}},t.prototype.handleUserJoin=function(e){return a(this,void 0,void 0,function(){var t,i,n,r;return c(this,function(){return t=JSON.parse(e),console.log("UserJoin: ",t),i=t,n=cc.instantiate(this.prefabsPlayerView).getComponent("PlayerViewTL"),this.players.push(n),this.node.addChild(n.node,9),this.readDataPlayer(n,i),v.Windown.updateAvatar(v.Windown.ObjToSFSObj(t),n.imgAvatar),n.setTurn(!1,0,!1,null),n.updatePlayerView(i),r=this.checkIndexPlayerIsExisted(),n._indexDynamic=r,n.node.setPosition(this.listPosView[r]),[2]})})},t.prototype.handleDc=function(e){return a(this,void 0,void 0,function(){var t,i,n,r,o,a,s,l,d,h,u,p,f,g,y,S,m=this;return c(this,function(c){switch(c.label){case 0:return this.audio.playEffect(this.audio.danhBaiVaBocBai),this.dangPhatBai?[4,this.getMakeDelay(3.2).prosime]:[3,2];case 1:c.sent(),c.label=2;case 2:for(t=JSON.parse(e),(i=this.getPlayerWithId(t.pid))&&i.setTurn(!1,0,!1,null),0!=t.idNext&&(t.idNext==v.Windown.User.userId&&this.audio.playEffect(this.audio.denTurn),this.getPlayerWithId(t.idNext).setTurn(!0,this.timeTurn,!0,null)),t.agc>0&&((n=this.getPlayerWithId(t.idc)).effectFlyMoney(t.agic,25),n.ag+=t.agic,n.updateAg(n.ag),(r=this.getPlayerWithId(t.idic)).effectFlyMoney(-t.agc,25),r.ag-=t.agc,r.updateAg(r.ag)),this.turnIdCurrent=t.idNext,this.lastTurnId=t.pid,this.turnIdCurrent===this.thisPlayer.id&&(this.dangPhatBai=!0),this.aniCardSpecial.node.active=!1,this.aniCardSpecial.node.zIndex=1001,p=0;p<this.players.length;p++)this.players[p].clearVectorCardD();if(i===this.thisPlayer&&(this.btnPass.node.active=!1,this.btnDiscard.node.active=!1),o=t.arrD,i===this.thisPlayer){for(p=0;p<o.length;p++)for(a=0;a<this.thisPlayer.vectorCard.length;a++)if(this.thisPlayer.vectorCard[a].code===o[p]){(f=this.thisPlayer.vectorCard[a]).isTouch=!1,i.vectorCardD.push(f),i.vectorCard.splice(a,1);break}}else for(p=0;p<o.length;p++)(f=i.vectorCard[0]).decodeCard(o[p]),f.setTextureWithCode(f.code),i.vectorCardD.push(f),i.vectorCard.splice(0,1);if(i.numberCard-=o.length,s=0,l=i._indexDynamic,d=this.listPosCardDanh[l],0===l||2===l?d=d.sub(cc.v2(.1375*this.sizeCardW*(o.length-1),0)):1===l&&(d=d.sub(cc.v2(.275*this.sizeCardW*o.length,0))),C.default.check3DoiThongTL(i.vectorCardD)||C.default.check4DoiThongTL(i.vectorCardD)||C.default.checkTuQuy(i.vectorCardD)||C.default.checkSetOfTwos(i.vectorCardD)){for(h=(h=cc.v2(0,-20)).sub(cc.v2(.275*this.sizeCardW*(o.length-1),0)),p=0;p<i.vectorCardD.length;p++)f=i.vectorCardD[p],u=f.code,f.setTextureWithCode(0),f.node.zIndex=this.zIndexCardD,f.isTouch=!1,this.zIndexCardD++,g=cc.moveTo(.5,h).easing(cc.easeCubicActionOut()),f.node.runAction(cc.sequence(cc.delayTime(s),g)),this.showSpecialCard(f.node,u,s),s+=.05,h=h.add(cc.v2(.55*this.sizeCardW,0));this.node.runAction(cc.sequence(cc.delayTime(s+.1),cc.callFunc(function(){m.dangPhatBai=!1,C.default.check3DoiThongTL(i.vectorCardD)?(m.aniCardSpecial.node.active=!0,m.aniCardSpecial.setAnimation(0,"3 DOI THONG",!1)):C.default.check4DoiThongTL(i.vectorCardD)?(m.aniCardSpecial.node.active=!0,m.aniCardSpecial.setAnimation(0,"4 DOI THONG",!1)):C.default.checkTuQuy(i.vectorCardD)&&(m.aniCardSpecial.node.active=!0,m.aniCardSpecial.setAnimation(0,"TU QUY 2",!1)),i===m.thisPlayer?m.sortCardView():(m.lbNumberCard[l].string=i.numberCard.toString(),0===i.numberCard&&(m.lbNumberCard[l].node.active=!1))}),cc.delayTime(2),cc.callFunc(function(){for(var e=0;e<i.vectorCardD.length;e++){var t=i.vectorCardD[e];t.node.zIndex=m.zIndexCardD,m.zIndexCardD++;var n=cc.moveTo(.2,d).easing(cc.easeCubicActionInOut()),r=cc.scaleTo(.15,.5),o=cc.spawn(r,n);t.node.runAction(o),d=d.add(cc.v2(.275*m.sizeCardW,0))}m.turnIdCurrent===m.thisPlayer.id&&(m.btnPass.node.active=!0,m.btnDiscard.node.active=!0,m.btnPass.enabled=!0,m.btnDiscard.enabled=!0,m.btnPass.interactable=!0,m.btnDiscard.interactable=!0,m.btnDiscard.node.setPosition(cc.v2(140,m.btnDiscard.node.position.y)),m.lbDiscard.string="\u0110\xe1nh B\xe0i",m.sortCardSelect()),m.aniCardSpecial.node.active=!1})))}else{for(p=0;p<i.vectorCardD.length;p++)(f=i.vectorCardD[p]).node.zIndex=this.zIndexCardD,f.isTouch=!1,this.zIndexCardD++,g=cc.moveTo(.2,d).easing(cc.easeCubicActionInOut()),y=cc.scaleTo(.15,.5),S=cc.spawn(y,g),f.node.runAction(cc.sequence(cc.delayTime(s),S)),s+=.03,d=d.add(cc.v2(.275*this.sizeCardW,0));this.node.runAction(cc.sequence(cc.delayTime(s+.1),cc.callFunc(function(){m.dangPhatBai=!1,i===m.thisPlayer?m.sortCardView():(m.lbNumberCard[l].string=i.numberCard.toString(),0===i.numberCard&&(m.lbNumberCard[l].node.active=!1)),m.turnIdCurrent===m.thisPlayer.id&&(m.btnPass.node.active=!0,m.btnDiscard.node.active=!0,m.btnPass.enabled=!0,m.btnDiscard.enabled=!0,m.btnPass.interactable=!0,m.btnDiscard.interactable=!0,m.btnDiscard.node.setPosition(cc.v2(140,m.btnDiscard.node.position.y)),m.lbDiscard.string="\u0110\xe1nh B\xe0i",m.sortCardSelect())})))}return[2]}})})},t.prototype.onClickTest=function(){this.aniCardSpecial.node.active=!0,this.aniCardSpecial.setAnimation(0,"TU QUY 2",!1)},t.prototype.handlePass=function(e){return a(this,void 0,void 0,function(){var t,i,n,r;return c(this,function(){if(t=JSON.parse(e),(i=this.getPlayerWithId(t.pid))&&i.setTurn(!1,0,!1,null),0!=t.idNext&&this.getPlayerWithId(t.idNext).setTurn(!0,this.timeTurn,!0,null),this.turnIdCurrent=t.idNext,i===this.thisPlayer&&(this.btnPass.node.active=!1,this.btnDiscard.node.active=!1,this.allCardDown()),t.nt){for(this.turnIdCurrent===this.thisPlayer.id&&(cc.log("Tat cai pass di"),this.btnPass.node.active=!1,this.btnDiscard.node.active=!0,this.btnDiscard.enabled=!0,this.btnDiscard.interactable=!0,this.btnDiscard.node.setPosition(cc.v2(0,this.btnDiscard.node.getPosition().y)),this.lbDiscard.string="\u0110\xe1nh B\xe0i"),n=0;n<this.players.length;n++)this.players[n].clearVectorCardD();for(this.lastTurnId=0,this.aniCardSpecial.node.active=!1,n=0;n<this.listSpritePass.length;n++)this.listSpritePass[n].node.active=!1;this.zIndexCardD=60}else this.turnIdCurrent===this.thisPlayer.id&&(this.btnPass.node.active=!0,this.btnDiscard.node.active=!0,this.btnPass.enabled=!0,this.btnDiscard.enabled=!0,this.btnPass.interactable=!0,this.btnDiscard.interactable=!0,this.btnDiscard.node.setPosition(cc.v2(140,this.btnDiscard.node.position.y)),this.lbDiscard.string="\u0110\xe1nh B\xe0i"),(r=this.listSpritePass[i._indexDynamic]).node.active=!0,r.node.setScale(0),r.node.runAction(cc.scaleTo(.2,1));return[2]})})},t.prototype.handleFinish=function(e){return a(this,void 0,void 0,function(){var t,i,n,r,o,a,s,l,d,h,u,p=this;return c(this,function(){for(this.audio.playEffect(this.audio.alert),this.isFinish=!0,t=JSON.parse(e),i=JSON.parse(t.data),cc.log("Handle Finish: ",i),this.listDataPlayerResult=[],this.aniFinish.node.active=!0,this.aniFinish.setAnimation(0,"finish",!1),this.aniCardSpecial.node.active=!1,n=0;n<i.length;n++)if(r=i[n],null!==(o=this.getPlayerWithId(r.playerId))){for(o==this.thisPlayer&&(v.Windown.User.userAg=i[n].ag),o.point=r.score,a={ag:r.ag,point:r.score,typeWin:r.TypeWin,lstDenLang:[],id:r.playerId},this.listDataPlayerResult.push(a),s=r.arr,l=0;l<s.length;l++)null==o.vectorCard[l]&&null==o.vectorCard[l]||o.vectorCard[l].decodeCard(s[l]);if(t.tw>0&&t.wn&&t.idw==r.playerId){for(cc.log("Player Spec:",o.displayName),this.playerSpecail=new S.default,this.playerSpecail.name=o.displayName,this.playerSpecail.info=o.info,this.playerSpecail.typeWin=t.tw,this.playerSpecail.id=o.id,l=0;l<s.length;l++)(d=this.getCard()).decodeCard(s[l]),d.node.setScale(.85),this.playerSpecail.vectorCard.push(d);cc.log("-=--==--=-=-==--=-=--=----=-=--=-==-=>>>>>>> Tienlen win special: "+this.playerSpecail.vectorCard.toString())}}return cc.log("this.playerSpecail=:",this.playerSpecail),this.playerSpecail&&this.node.stopAllActions(),(h=[]).push(cc.delayTime(.5)),h.push(cc.callFunc(function(){p.prepareFinish()})),h.push(cc.delayTime(1)),this.playerSpecail?(h.push(cc.callFunc(function(){p.TienLenCardSpecial()})),h.push(cc.delayTime(2.5)),h.push(cc.callFunc(function(){p.aniWinSpecial.node.parent.active=!1,p.showCard(t)})),h.push(cc.delayTime(2.5))):(h.push(cc.callFunc(function(){p.showCard(t)})),h.push(cc.delayTime(2.5))),h.push(cc.callFunc(function(){p.showExchangeMoney(i)})),h.push(cc.delayTime(4)),h.push(cc.callFunc(function(){p.handleFinishGame()})),u=cc.sequence(h),this.node.runAction(u),[2]})})},t.prototype.getCard=function(){return this.cardPool.size()<1?cc.instantiate(this.cardPrefab).getComponent("CardTL"):this.cardPool.get().getComponent("CardTL")},t.prototype.updatePositionPlayerView=function(){for(var e=0;e<this.players.length;e++){var t=this.getDynamicIndex(this.getIndexOf(this.players[e]));cc.log("index Update Pos: ",t),this.players[e]._indexDynamic=t,this.players[e].node.setPosition(this.listPosView[t])}},t.prototype.getDynamicIndex=function(e){if(0==e)return 0;var t=e;return 2===this.players.length&&t++,t},t.prototype.getIndexOf=function(e){var t=this.getIndexOfPlayer(e),i=this.players.length;return this.thisPlayer&&(i=this.getIndexOfPlayer(this.thisPlayer)),(t+this.players.length-i)%this.players.length},t.prototype.getIndexOfPlayer=function(e){return this.players.indexOf(e)},t.prototype.checkIndexPlayerIsExisted=function(){for(var e=[],t=0;t<this.players.length;t++)this.players[t]._indexDynamic>=0&&this.players[t]._indexDynamic<this.listPosView.length&&e.push(this.players[t]._indexDynamic);var i=[];for(t=0;t<this.listPosView.length;t++)i.push(t);for(t=0;t<i.length;t++)if(!e.includes(t))return cc.log("index fill: ",t),t},t.prototype.getPlayerWithId=function(e){for(var t=0;t<this.players.length;t++)if(e==this.players[t].id)return this.players[t];return null},t.prototype.onClickSortCard=function(){var e=this;this.audio.playEffect(this.audio.click),cc.log("=---=-=-=-=-=-==-=-=-=-=-=-==-=-> Tienlen sort"),this.typeSort=(this.typeSort+1)%3,cc.log("OnClickSort: ",this.typeSort),0===this.typeSort?this.thisPlayer.vectorCard.sort(function(e,t){var i=e.N-t.N;return 0===i&&(i=e.S-t.S),i}):1===this.typeSort?this.thisPlayer.vectorCard.sort(function(e,t){var i=t.N-e.N;return 0===i&&(i=e.S-t.S),i}):this.thisPlayer.vectorCard.sort(function(e,t){var i=e.S-t.S;return 0===i&&(i=e.N-t.N),i}),this.sortCard(),cc.tween(this.node).call(function(){e.btnSort.interactable=!1}).delay(.3).call(function(){e.btnSort.interactable=!0}).start()},t.prototype.sortCard=function(){var e=this,t=Math.round(this.thisPlayer.vectorCard.length/2*-1);this.dangPhatBai=!0,this.numCardSelect=0;for(var i,n=function(e){var n=r.thisPlayer.vectorCard[e];n.node.stopAllActions(),n.node.runAction(cc.scaleTo(.2,.85).easing(cc.easeCubicActionOut())),n.node.zIndex=50+e,n.node.opacity=255,i=r.listPosCard[0].add(cc.v2(.4675*r.sizeCardW*t,0));var o=cc.moveTo(.15,r.listPosCard[0]).easing(cc.easeCubicActionOut()),a=cc.moveTo(.15,i).easing(cc.easeCubicActionOut()),c=cc.sequence(o,a,cc.callFunc(function(){n.isTouch=!0,n.isSelect=!1}));n.node.runAction(c),t++},r=this,o=0;o<this.thisPlayer.vectorCard.length;o++)n(o);this.node.runAction(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){e.dangPhatBai=!1})))},t.prototype.macBookCard=function(e){for(var t=0;t<=this.thisPlayer.vectorCard.length;t++){var i=.85,n=this.thisPlayer.vectorCard[t];t!=e-1&&t!=e+1||(i=1),t!=e-2&&t!=e+2||(i=1),null!=n&&t!=e&&n.node.runAction(cc.scaleTo(.2,i).easing(cc.easeCubicActionOut())),t==e&&n.node.setScale(1.1)}},t.prototype.windowCard=function(){for(var e=0;e<this.thisPlayer.vectorCard.length;e++){var t=this.thisPlayer.vectorCard[e];null!=t&&t.node.runAction(cc.scaleTo(.2,.85).easing(cc.easeCubicActionOut()))}},t.prototype.suggestOnTouch=function(e,t){var i=this.getPlayerWithId(t);if(this.listCardSuggest=[],i){var n=i.vectorCardD,r=n.length,o=this.getTypeCard(n),a=n[r-1];switch(o){case 0:case 1:this.listCardSuggest=this.getlistDoiXam(e,o,a);break;case 2:case 3:this.listCardSuggest=this.getlistSanh(e,o,r,a);break;case 4:if(this.listCardSuggest=this.getTuQuy(e,a),this.listCardSuggest.length>0)break;if(this.listCardSuggest=this.getBonDoiThong(e,a),this.listCardSuggest.length>0)break;this.listCardSuggest=this.getBaDoiThong(e,a),0==this.listCardSuggest.length&&this.listCardSuggest.push(e);break;case 5:if(this.listCardSuggest=this.getBonDoiThong(e,a),this.listCardSuggest.length>0)break;this.listCardSuggest=this.getTuQuy(e,null),0==this.listCardSuggest.length&&this.listCardSuggest.push(e);break;case 6:if(this.listCardSuggest=this.getTuQuy(e,null),this.listCardSuggest.length>0)break;this.listCardSuggest=this.getBaDoiThong(e,a),0==this.listCardSuggest.length&&this.listCardSuggest.push(e);break;case 7:this.listCardSuggest=this.getBonDoiThong(e,a),0==this.listCardSuggest.length&&this.listCardSuggest.push(e);break;case 8:this.listCardSuggest=this.getTuQuy(e,a),0==this.listCardSuggest.length&&this.listCardSuggest.push(e);break;case 9:this.listCardSuggest=this.getHaiDoiThong(e,a),0==this.listCardSuggest.length&&this.listCardSuggest.push(e);break;case-1:this.listCardSuggest.push(e)}}},t.prototype.getTypeCard=function(e){return C.default.checkDoiTL(e)?0:C.default.checkXamTL(e)?1:C.default.ckeckThungPhaSanhTL(e)?3:C.default.checkSanhTL(e)?2:C.default.checkHaiTL(e)?4:C.default.checkDoiHaiTL(e)?5:C.default.check3DoiThongTL(e)?6:C.default.check4DoiThongTL(e)?7:C.default.checkTuQuy(e)?8:-1},t.prototype.getlistDoiXam=function(e,t,i){var n=this.thisPlayer.vectorCard.slice();n.sort(function(e,t){var i=e.S-t.S;return 0===i&&(i=e.N-t.N),i});var r=[],o=1,a=0;if(r.push(e),e.N<i.N&&2!==e.N)return r;if(e.N>i.N&&2===i.N)return r;for(var c=0;c<n.length;c++){if(n[c].N===e.N&&n[c].code!==e.code&&(r.push(n[c]),o++),0===t&&2===o){if(e.N==i.N&&i.N>5)for(var s=0;s<r.length;s++)r[s].S<i.S&&a++;break}if(1===t&&3===o)break}return(0===t&&o<2||1===t&&o<3||2===a)&&(r=[]).push(e),r},t.prototype.getTuQuy=function(e,t){var i=this.thisPlayer.vectorCard.slice(),n=this.findTuQuy(i);console.log("GetTuQuy: ",n);for(var r=[],o=0;o<n.length;o++)for(var a=0;a<n[o].length;a++)if(null!=t){if(n[o][a].N==e.N&&n[o][a].N>t.N){r=n[o];break}}else if(n[o][a].N==e.N){r=n[o];break}return r},t.prototype.getHaiDoiThong=function(e,t){var i=this.thisPlayer.vectorCard.slice(),n=this.findTwoPairs(i);console.log("GetTwoPairs: ",n);for(var r=[],o=0;o<n.length;o++)if(n[o].includes(e)&&n[o][n[o].length-1].N>t.N){r=n[o];break}return r},t.prototype.getBaDoiThong=function(e,t){var i=this.thisPlayer.vectorCard.slice(),n=this.findThreePairs(i);console.log("GetThreePairs: ",n);for(var r=[],o=0;o<n.length;o++)if(n[o].includes(e)&&n[o][n[o].length-1].N>t.N){r=n[o];break}return r},t.prototype.getBonDoiThong=function(e,t){var i=this.thisPlayer.vectorCard.slice(),n=this.findFourPairs(i);console.log("GetFourPairs: ",n);for(var r=[],o=0;o<n.length;o++)if(n[o].includes(e)&&n[o][n[o].length-1].N>t.N){r=n[o];break}return r},t.prototype.getlistSanh=function(e,t,i,n){var r=this.thisPlayer.vectorCard.slice();r.sort(function(e,t){var i=e.N-t.N;return 0===i&&(i=e.S-t.S),i});var o=[],a=1,c=1,s=null;o.push(e);for(var l=0;l<r.length&&(r[l].S===e.S&&r[l].N===e.N+a&&(o.push(r[l]),a++),a!==i);l++);if(a!==i)for(r.sort(function(e,t){var i=t.N-e.N;return 0===i&&(i=e.S-t.S),i}),l=0;l<r.length;l++)if(r[l].N===e.N-c&&r[l].S===e.S&&(o.push(r[l]),c++),c+a-1===i){o.sort(function(e,t){return e.N-t.N});break}if(2===t&&(o.length!==i||o[i-1].N<n.N||o[i-1].N===n.N&&o[i-1].S<n.S&&n.N>5)){for((o=[]).push(e),a=1,c=1,s=null,r.sort(function(e,t){var i=e.N-t.N;return 0===i&&(i=e.S-t.S),i}),l=0;l<r.length;l++)if(r[l].N===e.N+a&&(o.push(r[l]),a++),a===i){s=r[l];for(var d=l+1;d<r.length;d++)r[d].N===s.N&&r[d].S>s.S&&(s=r[d],o.pop(),o.push(s));break}if(a!==i)for(r.sort(function(e,t){var i=t.N-e.N;return 0===i&&(i=e.S-t.S),i}),l=0;l<r.length&&(r[l].N===e.N-c&&(o.push(r[l]),c++),c+a-1!==i);l++);if(o.length===i)for(o.sort(function(e,t){return e.N-t.N}),s=o[i-1],l=0;l<r.length;l++)r[l].N===s.N&&r[l].S>s.S&&(s=r[l],o.pop(),o.push(s))}return o.length!==i?(o=[]).push(e):(o.sort(function(e,t){return e.N-t.N}),(o[i-1].N<n.N||o[i-1].N===n.N&&o[i-1].S<n.S&&n.N>5)&&(o=[]).push(e)),o},t.prototype.findContainsTwoCardSelected=function(e,t,i){var n=[];cc.log("card1:",t),cc.log("card2:",i);for(var r=0;r<e.length;r++)if(e[r].includes(t)&&e[r].includes(i)&&t!==i)return e[r].slice();return n},t.prototype.findThreeCards=function(e){var t=[],i=s(e);if(t.sort(function(e,t){return e.N-t.N}),!C.default.checkXam(e))return t;e.sort(function(e,t){return e.N-t.N});for(var n=i.length-1;n>1;n--){var r=[];i[n].N==i[n-2].N&&(r.push(i[n],i[n-1],i[n-2]),t.push(r))}return t},t.prototype.findFourPairs=function(e){var t=[],i=[],n=[];if(e.length<8)return[];e.sort(function(e,t){return e.N-t.N});for(var r=0;r<e.length-2;r++){var o=e.slice(r,r+3);C.default.checkXam(o)&&(i.push(o),e=e.slice(0,r).concat(e.slice(r+1,e.length).concat(o[0])),n.push(o[0]))}for(r=0;r<e.length-7;r++)o=e.slice(r,r+8),C.default.check4DoiThongTL(o)&&t.push(o);for(var a=0;a<n.length;a++)for(r=0;r<t.length;r++)for(var c=t[r].slice(),s=0;s<c.length;s++)if(c[s].N==n[a].N&&c[s].S!=n[a].S){c[s]=n[a],t.push(c);break}return t},t.prototype.findThreePairs=function(e){var t=[],i=[],n=[];if(e.length<6)return[];e.sort(function(e,t){return e.N-t.N});for(var r=0;r<e.length-2;r++){var o=e.slice(r,r+3);C.default.checkXam(o)&&(i.push(o),e=e.slice(0,r).concat(e.slice(r+1,e.length).concat(o[0])),n.push(o[0]))}for(r=0;r<e.length-5;r++)o=e.slice(r,r+6),C.default.check3DoiThongTL(o)&&t.push(o);for(var a=0;a<n.length;a++)for(r=0;r<t.length;r++)for(var c=t[r].slice(),s=0;s<c.length;s++)if(c[s].N==n[a].N&&c[s].S!=n[a].S){c[s]=n[a],t.push(c);break}return t},t.prototype.findTwoPairs=function(e){var t=[],i=[],n=[];if(e.length<4)return[];e.sort(function(e,t){return e.N-t.N});for(var r=0;r<e.length-2;r++){var o=e.slice(r,r+3);C.default.checkXam(o)&&(i.push(o),e=e.slice(0,r).concat(e.slice(r+1,e.length).concat(o[0])),n.push(o[0]))}for(r=0;r<e.length-3;r++)o=e.slice(r,r+4),console.log("GetTwoPairs: ",C.default.check2DoiThongTL(o)),console.log("GetTwoPairs: ",o),C.default.check2DoiThongTL(o)&&t.push(o);for(var a=0;a<n.length;a++)for(r=0;r<t.length;r++)for(var c=t[r].slice(),s=0;s<c.length;s++)if(c[s].N==n[a].N&&c[s].S!=n[a].S){c[s]=n[a],t.push(c);break}return console.log("GetTwoPairs: ",t),t},t.prototype.findTuQuy=function(e){var t=s(e),i=[];if(!C.default.checkTuQuy(t))return i;t.sort(function(e,t){return e.N-t.N});for(var n=t.length-1;n>2;n--){var r=[];t[n].N===t[n-3].N&&(console.log("check tuquy: ",t),r.push(t[n]),r.push(t[n-1]),r.push(t[n-2]),r.push(t[n-3]),i.push(r))}return console.log("check tuquy2: ",i),i},t.prototype.findStraightCard=function(e){e.sort(function(e,t){var i=e.N-t.N;return 0===i&&(i=e.S-t.S),i});var t=[],i=0,n=[];console.log("SameN sort:  ",e);for(var r=0;r<e.length-1;r++)e[r].N==e[r+1].N&&2!==e[r].N&&(n.includes(e[r+1].N)||n.push(e[r+1]));for(;i<e.length-1;){var o=[],a=0;if(2!=e[i].N){for(o.push(e[i]),r=i+1;r<e.length;r++)e[i].N!=e[r].N&&(o.push(e[r]),this.checkStraightCard(o)||o.pop());o.length>=3&&(t.push(o),a=o.length),i+a<e.length-3&&a>0?i+=a:i++}else i++}console.log("SameN: ",n),console.log("SameN Result: ",t);for(var c=0;c<n.length;c++)for(r=0;r<t.length;r++)for(var s=t[r].slice(),l=0;l<s.length;l++)if(s[l].N==n[c].N&&s[l].S!=n[c].S){s[l]=n[c],t.push(s);break}return console.log("SameN Result2: ",t),t},t.prototype.checkStraightCard=function(e){for(var t=0;t<e.length-1;t++)if(e[t].N+1!=e[t+1].N)return!1;return!0},t.prototype.onClickPass=function(){v.Windown.TienLen.audio.playClick(),this.sendPass(),this.allCardDown()},t.prototype.onClickBeat=function(){v.Windown.TienLen.audio.playClick();for(var e=[],t=0;t<this.thisPlayer.vectorCard.length;t++)this.thisPlayer.vectorCard[t].isSelect&&(cc.log("-=-==--=-=-=-=-=-==---=-=-=->>>>>>>>> Tienlen: "+this.thisPlayer.vectorCard[t].nameCard),e.push(this.thisPlayer.vectorCard[t].code));cc.log("-=-==--=-=-=-=-=-==---=-=-=->>>>>>>>> Tienlen size: "+e.length),this.sendDc(e)},t.prototype.allCardDown=function(){if(!(this.thisPlayer.vectorCard.length<1)&&this.isAllowClickDownAllCard)for(var e=this.listPosCard[0],t=0;t<this.thisPlayer.vectorCard.length;t++){var i=this.thisPlayer.vectorCard[t],n=i.node.position.x;i.node.stopAllActions(),i.node.runAction(cc.scaleTo(.4,.85).easing(cc.easeCubicActionOut())),i.node.runAction(cc.moveTo(.2,cc.v2(n,e.y)).easing(cc.easeCubicActionOut())),i.isSelect=!1,this.numCardSelect=0}},t.prototype.sendDc=function(e){var t=f.ConectManager.getIns().getSFSObj();if(t.putInt("pid",this.thisPlayer.id),t.putIntArray("arr",e),this.sfsObjTest=t,null!=this.sfsObjTest)return f.ConectManager.getIns().sendRequest("dc",this.sfsObjTest,this.roomSFS),cc.log("send dc:",t),void(this.sfsObjTest=null)},t.prototype.sendPass=function(){var e=f.ConectManager.getIns().getSFSObj();if(e.putInt("pid",this.thisPlayer.id),this.sfsObjTest=e,null!=this.sfsObjTest)return f.ConectManager.getIns().sendRequest("pa",this.sfsObjTest,this.roomSFS),cc.log("send pa:",e),this.sfsObjTest=null,void this.thisPlayer.setTurn(!1,0,!1,null)},t.prototype.showSpecialCard=function(e,t,i){e.zIndex=1e3,e.runAction(cc.sequence(cc.delayTime(i),cc.spawn(cc.scaleTo(.15,.01,1.2),cc.skewTo(.15,0,-15)),cc.callFunc(function(){e.skewY=15,e.getComponent("CardTL").setTextureWithCode(t)}),cc.spawn(cc.scaleTo(.15,1.2),cc.skewTo(.15,0,0)),cc.delayTime(.1),cc.scaleTo(.2,1).easing(cc.easeCubicActionIn()),cc.delayTime(.2)))},t.prototype.showBlackCover=function(){},t.prototype.hideBlackCover=function(){},t.prototype.prepareFinish=function(){this.bgHint.node.active=!1,this.btnSort.node.active=!1,this.btnPass.node.active=!1,this.btnDiscard.node.active=!1,this.isAllowClickDownAllCard=!1,this.turnIdCurrent=0,this.lastTurnId=0;for(var e=0;e<this.lbNumberCard.length;e++)this.lbNumberCard[e].node.active=!1;for(e=0;e<this.listSpritePass.length;e++)this.listSpritePass[e].node.active=!1;for(e=0;e<this.players.length;e++){for(var t=this.players[e],i=t.vectorCard.length,n=0;n<i;n++){var r=t.vectorCard[n];r.node.active=!1,r.isTouch=!1}t.clearVectorCardD()}},t.prototype.TienLenCardSpecial=function(){var e=this;cc.log("!> tien len card special"),this.aniFinish.node.active=!1,v.Windown.updateAvatar(v.Windown.ObjToSFSObj(this.playerSpecail.info),this.avtSpecial),this.playerSpecail.vectorCard.sort(function(e,t){var i=e.N-t.N;return 0===i&&(i=e.S-t.S),i});var t=cc.v2(0,-170);t=t.sub(cc.v2(2.805*this.sizeCardW,0));for(var i=0;i<this.playerSpecail.vectorCard.length;i++){var n=this.playerSpecail.vectorCard[i];cc.log("=---==-=--=-=-==-=--==--=>>> Tienlen, card xxxx: ",t),this.node.addChild(n.node),n.setTextureWithCode(n.code),n.node.setPosition(t.x,t.y),n.node.zIndex=300+i,t=t.add(cc.v2(.4675*this.sizeCardW,0))}switch(this.aniWinSpecial.node.active=!0,this.aniWinSpecial.node.parent.active=!0,this.aniWinSpecial.node.zIndex=999,this.lbNameWin.string=this.playerSpecail.name,this.aniWinSpecial.setAnimation(0,"animation",!1),this.playerSpecail.typeWin){case 1:this.sprWinSpectical.spriteFrame=this.listSprTextWinSpectical[0];break;case 2:this.sprWinSpectical.spriteFrame=this.listSprTextWinSpectical[1];break;case 3:this.sprWinSpectical.spriteFrame=this.listSprTextWinSpectical[2];break;case 4:this.sprWinSpectical.spriteFrame=this.listSprTextWinSpectical[3];break;case 5:this.sprWinSpectical.spriteFrame=this.listSprTextWinSpectical[4];break;case 6:this.sprWinSpectical.spriteFrame=this.listSprTextWinSpectical[5]}this.sprWinSpectical.node.active=!1,setTimeout(function(){e.sprWinSpectical.node.active=!0},500)},t.prototype.showCard=function(e){this.aniWinSpecial.node.active=!0,this.aniFinish.node.active=!1,this.playerSpecail&&(this.playerSpecail.clearAllCard(),this.playerSpecail=null);for(var t=0;t<this.players.length;t++){var i=this.players[t],n=i.vectorCard.length,r=i._indexDynamic,o=this.listPosCard[r];if(!(0===n||i.typeWin>0)){cc.log("Show point:",i.point),this.listBgScore[r].node.active=!0,this.listLbScore[r].string=""+i.point,0===r?o=o.sub(cc.v2(.4675*this.sizeCardW*n/2,0)):1!==r&&2!==r||(o=o.sub(cc.v2(.225*this.sizeCardW*(n-1),0)));for(var a=0;a<n;a++){var c=i.vectorCard[a];if(c.node.zIndex=50+a,c.node.active=!0,c.setTextureWithCode(c.code),c.node.setPosition(o),i===this.thisPlayer){var s=o.add(cc.v2(this.sizeCardW*a*.4675+20,0));c.node.setScale(.85)}else s=o.add(cc.v2(this.sizeCardW*a*.225,0));c.node.runAction(cc.moveTo(.2,s).easing(cc.easeCubicActionInOut()))}13===n&&(cc.log("tienlenSpecial: ",i.id+" || 0"),i.id!=e.idw&&(this.aniChayBai[r].node.active=!0,this.aniChayBai[r].setAnimation(0,"animation",!0)))}}},t.prototype.showExchangeMoney=function(e){for(var t=this,i=0;i<this.players.length;i++)this.players[i].clearAllCard();for(i=0;i<this.listBgScore.length;i++)this.listBgScore[i].node.active=!1,this.aniChayBai[i].node.active=!1;for(i=0;i<e.length;i++){var n=this.getPlayerWithId(e[i].playerId);if(e[i].ag-n.ag<0){cc.log("Chip lose: ",e[i].ag-n.ag),n===this.thisPlayer&&this.audio.playEffect(this.audio.Lose),this.audio.playEffect(this.audio.nemxu),n.showEffectWinLose(-1),n.effectFlyMoney(e[i].ag-n.ag,25),n.updateAg(e[i].ag);for(var r=0,o=0;o<10;o++){var a=new cc.Node;a.addComponent(cc.Sprite),a.getComponent(cc.Sprite).spriteFrame=this.icon_chips,this.node.addChild(a),this.vtChipFinish.push(a),a.setPosition(n.node.getPosition());var c=cc.v2(0,0),s=Math.floor(80*Math.random())-40,l=Math.floor(80*Math.random())-40;c=c.add(cc.v2(s,l));var d=cc.moveTo(.25,c).easing(cc.easeCubicActionInOut()),h=cc.delayTime(r);a.runAction(cc.sequence(h,d)),r+=.075}}}this.node.runAction(cc.sequence(cc.delayTime(2),cc.callFunc(function(){for(var i=0;i<e.length;i++){var n=t.getPlayerWithId(e[i].playerId);if(e[i].ag-n.ag>0){cc.log("Chip win: ",e[i].ag-n.ag),t.audio.playEffect(t.audio.nemxu),n===t.thisPlayer&&t.audio.playEffect(t.audio.Win),n.showEffectWinLose(1),n.effectFlyMoney(e[i].ag-n.ag),n.updateAg(e[i].ag);for(var r=0,o=0;o<t.vtChipFinish.length;o++){var a=t.vtChipFinish[o],c=cc.moveTo(.25,n.node.getPosition()).easing(cc.easeCubicActionInOut()),s=cc.fadeTo(.05,0),l=cc.delayTime(r);a.runAction(cc.sequence(l,c,s,cc.callFunc(function(){a.active=!1}))),r+=.05}}}})))},t.prototype.handleFinishGame=function(){for(var e=0;e<this.players.length;e++)this.players[e].clearAllCard();for(var t=0;t<this.vtChipFinish.length;t++)this.vtChipFinish[t].destroy();this.vtChipFinish=[];for(var i=0;i<this.vtChipDenLang.length;i++)this.vtChipDenLang[i].destroy();this.vtChipDenLang=[],this.aniFinish.node.active=!1,this.unscheduleAllCallbacks()},t.prototype.onClickMenuInGame=function(){return a(this,void 0,void 0,function(){var e;return c(this,function(t){switch(t.label){case 0:return v.Windown.TienLen.audio.playClick(),[4,v.Windown.getPrefabRes(d.PathResource.MenuIngame)];case 1:return e=t.sent(),this.node.addChild(cc.instantiate(e),999),[2]}})})},t.prototype.onClickQuickChat=function(){return a(this,void 0,void 0,function(){var e,t;return c(this,function(i){switch(i.label){case 0:return v.Windown.TienLen.audio.playClick(),[4,v.Windown.getPrefabRes(d.PathResource.QuickChat)];case 1:return e=i.sent(),t=cc.instantiate(e),this.node.addChild(t,999),[2]}})})},t.prototype.handleChat=function(e){var t=JSON.parse(e),i=this.getPlayerWithId(t.id);this.createChat(i.node,t)},t.prototype.sendAutoExit=function(){var e=f.ConectManager.getIns().getSFSObj();if(this.sfsObjTest=e,null!=this.sfsObjTest)return f.ConectManager.getIns().sendRequest("autoExit",this.sfsObjTest,this.roomSFS),this.sfsObjTest=null,void cc.log("send autoExit")},t.prototype.handleChatI=function(e){var t=this,i=JSON.parse(e),n=this.getPlayerWithId(i.idt),r=this.getPlayerWithId(i.id),o=i.idItem,a=null,c=null;switch(o){case 0:a=this.thisPlayer.listAnimItems[0],c=this.thisPlayer.listSprItems[0];break;case 1:a=this.thisPlayer.listAnimItems[1],c=this.thisPlayer.listSprItems[1];break;case 2:a=this.thisPlayer.listAnimItems[2],c=this.thisPlayer.listSprItems[2];break;case 3:a=this.thisPlayer.listAnimItems[3],c=this.thisPlayer.listSprItems[3];break;case 4:a=this.thisPlayer.listAnimItems[4],c=this.thisPlayer.listSprItems[4]}var s=r.node.getPosition();if(n==r)for(var l=function(e){if(d.players[e]!=r){var i=d.players[e].node.getPosition();cc.tween(d.players[e].node).call(function(){t.effectItem(c,a,i,s,null)}).start()}},d=this,h=0;h<this.players.length;h++)l(h);else{var u=n.node.getPosition();cc.tween(n.node).call(function(){t.effectItem(c,a,u,s,null)}).start()}},t.prototype.effectItem=function(e,t,i,n,r){var o=this,a=this.createSprite(e),c=this.createAnimation(t);this.node.addChild(a.node,999),this.node.addChild(c.node,999),c.node.active=!1,a.node.setPosition(n),c.node.setPosition(i),cc.tween(a.node).to(.5,{position:i}).delay(.1).call(function(){a.destroy()}).start(),cc.tween(c.node).delay(.5).call(function(){c.node.active=!0,c.setAnimation(0,"animation",!1),o.audio.playEffect(r)}).delay(2).call(function(){c.node.destroy()}).start()},t.prototype.createAnimation=function(e){var t=new cc.Node("anim").addComponent(sp.Skeleton);return t.premultipliedAlpha=!1,t.skeletonData=e,t},t.prototype.createSprite=function(e){var t=new cc.Node("spr").addComponent(cc.Sprite);return t.spriteFrame=e,t},t.prototype.createChat=function(e,t){return a(this,void 0,void 0,function(){var i,n;return c(this,function(r){switch(r.label){case 0:return[4,v.Windown.getPrefabRes(d.PathResource.BubbleChat)];case 1:return i=r.sent(),(n=cc.instantiate(i)).getComponent("BubbleChat").initChat(t),e.addChild(n,99),[2]}})})},t.prototype.onClickRule=function(){v.Windown.TienLen.audio.playClick()},t.prototype.sendGetInfoRoomReconnect=function(){var e=f.ConectManager.getIns().getSFSObj();if(this.sfsObjTest=e,null!=this.sfsObjTest)return f.ConectManager.getIns().sendRequest("infoRoomTL",this.sfsObjTest,this.roomSFS),this.sfsObjTest=null,void cc.log("send infoRoom")},t.prototype.cleanGame=function(){this.node.stopAllActions(),this.cleanTable(),this.unscheduleAllCallbacks();for(var e=0;e<this.players.length;e++)this.players[e].cleanPlayerView(),this.players[e].node.destroy();this.players=[]},t.prototype.cleanTable=function(){for(var e=0;e<this.players.length;e++)this.players[e].clearAllCard();for(e=0;e<4;e++)this.lbNumberCard[e].node.active=!1,this.aniChayBai[e].node.active=!1,this.listBgScore[e].node.active=!1;this.btnPass.node.active=!1,this.btnDiscard.node.active=!1,this.bgHint.node.active=!1,this.aniCardSpecial.node.active=!1,this.aniFinish.node.active=!1,this.aniStartGame.node.active=!1,this.typeSort=2,this.isAllowClickDownAllCard=!1},o([T(cc.Label)],t.prototype,"lbInfo",void 0),o([T([cc.Vec2])],t.prototype,"listPosView",void 0),o([T([cc.Vec2])],t.prototype,"listPosCard",void 0),o([T([cc.Vec2])],t.prototype,"listPosCardDanh",void 0),o([T(cc.Button)],t.prototype,"btnMenu",void 0),o([T(cc.Button)],t.prototype,"btnQuickChat",void 0),o([T(cc.Button)],t.prototype,"btnPass",void 0),o([T(cc.Button)],t.prototype,"btnDiscard",void 0),o([T(cc.Label)],t.prototype,"lbDiscard",void 0),o([T(cc.Button)],t.prototype,"btnSort",void 0),o([T(cc.Label)],t.prototype,"lbTimeStart",void 0),o([T([cc.Label])],t.prototype,"lbNumberCard",void 0),o([T([cc.Sprite])],t.prototype,"listSpritePass",void 0),o([T([cc.Sprite])],t.prototype,"listBgScore",void 0),o([T([cc.Label])],t.prototype,"listLbScore",void 0),o([T(cc.Sprite)],t.prototype,"bgHint",void 0),o([T(cc.Label)],t.prototype,"lbHint",void 0),o([T(cc.Node)],t.prototype,"timerControl",void 0),o([T({visible:!1,type:[cc.Node]})],t.prototype,"vtChipFinish",void 0),o([T({visible:!1,type:[cc.Node]})],t.prototype,"vtChipDenLang",void 0),o([T(sp.Skeleton)],t.prototype,"aniCardSpecial",void 0),o([T(sp.Skeleton)],t.prototype,"aniWinSpecial",void 0),o([T(sp.Skeleton)],t.prototype,"aniStartGame",void 0),o([T(sp.Skeleton)],t.prototype,"aniFinish",void 0),o([T([sp.Skeleton])],t.prototype,"aniChayBai",void 0),o([T(cc.Label)],t.prototype,"lbNameWin",void 0),o([T(cc.Sprite)],t.prototype,"avtSpecial",void 0),o([T(cc.Sprite)],t.prototype,"sprWinSpectical",void 0),o([T([cc.SpriteFrame])],t.prototype,"listSprTextWinSpectical",void 0),o([T(cc.SpriteFrame)],t.prototype,"icon_chips",void 0),o([T(cc.Prefab)],t.prototype,"prefabsPlayerView",void 0),o([T(cc.Prefab)],t.prototype,"cardPrefab",void 0),o([T(y.default)],t.prototype,"audio",void 0),o([b],t)}(cc.Component);i.default=P,cc._RF.pop()},{"../../../Scritps/DefineTs/EVENT_MANAGER":void 0,"../../../Scritps/DefineTs/PathResource":void 0,"../../../Scritps/DefineTs/REQUEST_CODE":void 0,"../../../Scritps/DefineTs/TextDefine":void 0,"../../../Scritps/Game/GAME_TYPE":void 0,"../../../Scritps/Network/ConectManager":void 0,"../../../Scritps/Other/MakeDelay":void 0,"../../../Scritps/Windown":void 0,"./AudioTL":"AudioTL","./LogicManagerTL":"LogicManagerTL","./PlayerViewTL":"PlayerViewTL"}]},{},["AudioTL","CardTL","LogicManagerTL","PlayerViewTL","TienLenGameView"]);